Spec. file is: specfile
Parsed two: inode.c.orig, inode.c.new
Parsed two: mconsole_kern.c.orig, mconsole_kern.c.new
Comment
Parsed two: mtdsuper.c.orig, mtdsuper.c.new
Parsed two: mntpt.c.orig, mntpt.c.new
Parsed two: block_dev.c.orig, block_dev.c.new
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Comment
Reading file pair block_dev.c.orig block_dev.c.new
Reading file pair mntpt.c.orig mntpt.c.new
Reading file pair mtdsuper.c.orig mtdsuper.c.new
Reading file pair mconsole_kern.c.orig mconsole_kern.c.new
Reading file pair inode.c.orig inode.c.new
stmt:exprstmt(none) simple_assi(=) stmt:decl(N/H) fulltype[typec(N/H)] typec(N/H) reg() fulltype[ctype[btype[itype[sgn(signed),base(int)]]]] ctype[btype[itype[sgn(signed),base(int)]]] btype[itype[sgn(signed),base(int)]] itype[sgn(signed),base(int)] base(int) sgn(signed) fulltype[ctype[btype(void)]] ctype[btype(void)] btype(void) statem(N/H) logiop(&&) exp:const:int(0) stmt:goto(out) exp:ident(NULL) logiop(==) exp:const:int(1) aop(+) inc_elem(linux) 
[Main] Constructing all safe parts for 5 term pairs
[Main] Making safe parts for pair 1
[Main] terms that changed: 
[Main] Making safe parts for pair 2
[Main] terms that changed: 
[Main] Making safe parts for pair 3
[Main] terms that changed: 
[Main] Making safe parts for pair 4
[Main] terms that changed: 
[Main] Making safe parts for pair 5
[Main] terms that changed: 
Those were the safe parts
{{{
exp:record_ptr[exp:record_acc[meta(X0),meta(X1)],meta(X2)] ==> exp:record_ptr[exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)],meta(X2)]

exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)],meta(X4)] ==> exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)],meta(X4)]

stmt:if[exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)],meta(X4)],meta(X5),meta(X6)] ==> stmt:if[exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)],meta(X4)],meta(X5),meta(X6)]

stmt:if[exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)],meta(X4)],meta(X5),stmt:exprstmt(none)] ==> stmt:if[exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)],meta(X4)],meta(X5),stmt:exprstmt(none)]

exp:record_ptr[exp:record_acc[meta(X0),meta(X1)],meta(X2)] ==> exp:record_ptr[exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)],meta(X2)]

stmt:exprstmt:exp:assign[meta(X0),meta(X1),exp:record_ptr[exp:record_acc[meta(X2),meta(X3)],meta(X4)]] ==> stmt:exprstmt:exp:assign[meta(X0),meta(X1),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X2),ident(path)],meta(X3)],meta(X4)]]

stmt:exprstmt:exp:assign[simple_assi(=),meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)]] ==> stmt:exprstmt:exp:assign[simple_assi(=),meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)]]

stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)] ==> stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)]

def[fname(lookup_bdev),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)]] ==> def[fname(lookup_bdev),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)]]

prg2[includeN[inc_elem(linux),inc_elem(init.h)],includeN[inc_elem(linux),inc_elem(mm.h)],includeN[inc_elem(linux),inc_elem(fcntl.h)],includeN[inc_elem(linux),inc_elem(slab.h)],includeN[inc_elem(linux),inc_elem(kmod.h)],includeN[inc_elem(linux),inc_elem(major.h)],includeN[inc_elem(linux),inc_elem(smp_lock.h)],includeN[inc_elem(linux),inc_elem(highmem.h)],includeN[inc_elem(linux),inc_elem(blkdev.h)],includeN[inc_elem(linux),inc_elem(module.h)],includeN[inc_elem(linux),inc_elem(blkpg.h)],includeN[inc_elem(linux),inc_elem(buffer_head.h)],includeN[inc_elem(linux),inc_elem(writeback.h)],includeN[inc_elem(linux),inc_elem(mpage.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(uio.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(log2.h)],includeN[inc_elem(asm),inc_elem(uaccess.h)],includeL[inc_elem(internal.h)],decl(N/H),def[fname(BDEV_I),funtype[fulltype[typec(N/H)],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(container_of),exp:ident(inode),argtype(N/H),exp:ident(vfs_inode)]]],def[fname(I_BDEV),funtype[fulltype[typec(N/H)],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:&ref:exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)]]],mtop(N/H),def[fname(max_block),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(sz),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:binary_arith[aop(>>),exp:ident(sz),exp:ident(sizebits)]]],stmt:exprstmt(none)],stmt:return:exp:ident(retval)]],def[fname(kill_bdev),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)],ident(nrpages)],exp:const:int(0)],stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(invalidate_bh_lrus)],stmt:exprstmt:exp:call[exp:ident(truncate_inode_pages),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)],exp:const:int(0)]]],def[fname(set_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(||),exp:binary_logi[logiop(>),exp:ident(size),exp:ident(PAGE_SIZE)],exp:binary_logi[logiop(<),exp:ident(size),exp:const:int(512)]],exp:!:exp:call[exp:ident(is_power_of_2),exp:ident(size)]],stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(<),exp:ident(size),exp:call[exp:ident(bdev_hardsect_size),exp:ident(bdev)]],stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(size)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(sync_blockdev),exp:ident(bdev)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_blkbits)],exp:call[exp:ident(blksize_bits),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(kill_bdev),exp:ident(bdev)]],stmt:exprstmt(none)],stmt:return:exp:const:int(0)]],mtop(N/H),def[fname(sb_set_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:call[exp:ident(set_blocksize),exp:record_ptr[exp:ident(sb),ident(s_bdev)],exp:ident(size)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_blocksize)],exp:ident(size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_blocksize_bits)],exp:call[exp:ident(blksize_bits),exp:ident(size)]],stmt:return:exp:record_ptr[exp:ident(sb),ident(s_blocksize)]]],mtop(N/H),def[fname(sb_min_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(<),exp:ident(size),exp:ident(minsize)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:ident(minsize)],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(sb_set_blocksize),exp:ident(sb),exp:ident(size)]]],mtop(N/H),def[fname(blkdev_get_block),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(iblock),fulltype[typec(N/H)]],param[reg(),name(bh),fulltype[typec(N/H)]],param[reg(),name(create),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(>=),exp:ident(iblock),exp:call[exp:ident(max_block),exp:call[exp:ident(I_BDEV),exp:ident(inode)]]],stmt:comp{}[stmt:if[exp:ident(create),stmt:return:exp:-:exp:ident(EIO),stmt:exprstmt(none)],stmt:return:exp:const:int(0)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_bdev)],exp:call[exp:ident(I_BDEV),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_blocknr)],exp:ident(iblock)],stmt:exprstmt:exp:call[exp:ident(set_buffer_mapped),exp:ident(bh)],stmt:return:exp:const:int(0)]],def[fname(blkdev_get_blocks),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(iblock),fulltype[typec(N/H)]],param[reg(),name(bh),fulltype[typec(N/H)]],param[reg(),name(create),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(>),exp:binary_arith[aop(+),exp:ident(iblock),exp:ident(max_blocks)],exp:ident(end_block)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(max_blocks),exp:binary_arith[aop(-),exp:ident(end_block),exp:ident(iblock)]],stmt:if[exp:binary_logi[logiop(<=),exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(long)]]]],exp:ident(max_blocks)],exp:const:int(0)],stmt:comp{}[stmt:if[exp:ident(create),stmt:return:exp:-:exp:ident(EIO),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(max_blocks),exp:const:int(0)]],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_bdev)],exp:call[exp:ident(I_BDEV),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_blocknr)],exp:ident(iblock)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_size)],exp:binary_arith[aop(<<),exp:ident(max_blocks),exp:record_ptr[exp:ident(inode),ident(i_blkbits)]]],stmt:if[exp:ident(max_blocks),stmt:exprstmt:exp:call[exp:ident(set_buffer_mapped),exp:ident(bh)],stmt:exprstmt(none)],stmt:return:exp:const:int(0)]],def[fname(blkdev_direct_IO),funtype[fulltype[typec(N/H)],param[reg(),name(rw),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(iocb),fulltype[typec(N/H)]],param[reg(),name(iov),fulltype[typec(N/H)]],param[reg(),name(offset),fulltype[typec(N/H)]],param[reg(),name(nr_segs),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:return:exp:call[exp:ident(blockdev_direct_IO_no_locking),exp:ident(rw),exp:ident(iocb),exp:ident(inode),exp:call[exp:ident(I_BDEV),exp:ident(inode)],exp:ident(iov),exp:ident(offset),exp:ident(nr_segs),exp:ident(blkdev_get_blocks),exp:ident(NULL)]]],def[fname(blkdev_writepage),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(page),fulltype[typec(N/H)]],param[reg(),name(wbc),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(block_write_full_page),exp:ident(page),exp:ident(blkdev_get_block),exp:ident(wbc)]]],def[fname(blkdev_readpage),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(page),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(block_read_full_page),exp:ident(page),exp:ident(blkdev_get_block)]]],def[fname(blkdev_write_begin),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(mapping),fulltype[typec(N/H)]],param[reg(),name(pos),fulltype[typec(N/H)]],param[reg(),name(len),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(pagep),fulltype[typec(N/H)]],param[reg(),name(fsdata),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:*ref:exp:ident(pagep),exp:ident(NULL)],stmt:return:exp:call[exp:ident(block_write_begin),exp:ident(file),exp:ident(mapping),exp:ident(pos),exp:ident(len),exp:ident(flags),exp:ident(pagep),exp:ident(fsdata),exp:ident(blkdev_get_block)]]],def[fname(blkdev_write_end),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(mapping),fulltype[typec(N/H)]],param[reg(),name(pos),fulltype[typec(N/H)]],param[reg(),name(len),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(copied),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(page),fulltype[typec(N/H)]],param[reg(),name(fsdata),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(block_write_end),exp:ident(file),exp:ident(mapping),exp:ident(pos),exp:ident(len),exp:ident(copied),exp:ident(page),exp:ident(fsdata)]],stmt:exprstmt:exp:call[exp:ident(unlock_page),exp:ident(page)],stmt:exprstmt:exp:call[exp:ident(page_cache_release),exp:ident(page)],stmt:return:exp:ident(ret)]],def[fname(block_llseek),funtype[fulltype[typec(N/H)],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(offset),fulltype[typec(N/H)]],param[reg(),name(origin),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bd_inode),ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:call[exp:ident(i_size_read),exp:ident(bd_inode)]],stmt:switch[exp:ident(origin),stmt:comp{}[statem(N/H),stmt:jump(break),statem(N/H)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:-:exp:ident(EINVAL)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(>=),exp:ident(offset),exp:const:int(0)],exp:binary_logi[logiop(<=),exp:ident(offset),exp:ident(size)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:ident(offset),exp:record_ptr[exp:ident(file),ident(f_pos)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(file),ident(f_pos)],exp:ident(offset)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:ident(offset)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bd_inode),ident(i_mutex)]],stmt:return:exp:ident(retval)]],def[fname(block_fsync),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(filp),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(datasync),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(sync_blockdev),exp:call[exp:ident(I_BDEV),exp:record_ptr[exp:record_ptr[exp:ident(filp),ident(f_mapping)],ident(host)]]]]],decl(N/H),NCP(N/H),def[fname(bdev_alloc_inode),funtype[fulltype[typec(N/H)],param[reg(),name(sb),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:ident(ei),stmt:return:exp:ident(NULL),stmt:exprstmt(none)],stmt:return:exp:&ref:exp:record_ptr[exp:ident(ei),ident(vfs_inode)]]],def[fname(bdev_destroy_inode),funtype[fulltype[ctype[btype(void)]],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(bdi),ident(bdev)],ident(bd_inode_backing_dev_info)],exp:ident(NULL)],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(bdev_cachep),exp:ident(bdi)]]],def[fname(init_once),funtype[fulltype[ctype[btype(void)]],param[reg(),name(cachep),fulltype[typec(N/H)]],param[reg(),name(foo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(memset),exp:ident(bdev),exp:const:int(0),exp:sizeof:exp:*ref:exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(mutex_init),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(sema_init),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mount_sem)],exp:const:int(1)],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_inodes)]],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_list)]],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_holder_list)]],stmt:exprstmt:exp:call[exp:ident(inode_init_once),exp:&ref:exp:record_ptr[exp:ident(ei),ident(vfs_inode)]]]],def[fname(__bd_forget),funtype[fulltype[ctype[btype(void)]],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(list_del_init),exp:&ref:exp:record_ptr[exp:ident(inode),ident(i_devices)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(inode),ident(i_bdev)],exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(inode),ident(i_mapping)],exp:&ref:exp:record_ptr[exp:ident(inode),ident(i_data)]]]],NCP(N/H),decl(N/H),def[fname(bd_get_sb),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(get_sb_pseudo),exp:ident(fs_type),exp:const:string(bdev:),exp:&ref:exp:ident(bdev_sops),exp:const:int(0x62646576),exp:ident(mnt)]]],decl(N/H),NCP(N/H),decl(N/H),NCP(N/H),def[fname(hash),funtype[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],param[reg(),name(dev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:binary_arith[aop(+),exp:call[exp:ident(MAJOR),exp:ident(dev)],exp:call[exp:ident(MINOR),exp:ident(dev)]]]],def[fname(bdev_test),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)],ident(bd_dev)],exp:*ref:exp:cast[fulltype[typec(N/H)],exp:ident(data)]]]],def[fname(bdev_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)],ident(bd_dev)],exp:*ref:exp:cast[fulltype[typec(N/H)],exp:ident(data)]],stmt:return:exp:const:int(0)]],decl(N/H),NCP(N/H),mtop(N/H),NCP(N/H),def[fname(bdput),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(iput),exp:record_ptr[exp:ident(bdev),ident(bd_inode)]]]],mtop(N/H),NCP(N/H),NCP(N/H),NCP(N/H),mtop(N/H),NCP(N/H),mtop(N/H),def[fname(bdev_get_kobj),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:return:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(dev)],ident(kobj)]],stmt:return:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(dev)],ident(kobj)]]]]],def[fname(bdev_get_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:return:exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(holder_dir)]],stmt:return:exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(holder_dir)]]]]],def[fname(add_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(from),fulltype[typec(N/H)]],param[reg(),name(to),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(from),exp:!:exp:ident(to)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(sysfs_create_link),exp:ident(from),exp:ident(to),exp:call[exp:ident(kobject_name),exp:ident(to)]]]],def[fname(del_symlink),funtype[fulltype[ctype[btype(void)]],param[reg(),name(from),fulltype[typec(N/H)]],param[reg(),name(to),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(from),exp:!:exp:ident(to)],stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(sysfs_remove_link),exp:ident(from),exp:call[exp:ident(kobject_name),exp:ident(to)]]]],decl(N/H),def[fname(bd_holder_grab_dirs),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(bdev),exp:!:exp:ident(bo)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:call[exp:ident(kobject_get),exp:record_ptr[exp:ident(bo),ident(sdir)]]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(sdir)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(hdev)],exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bo),ident(sdir)],ident(parent)]]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(hdev)],stmt:goto(fail_put_sdir),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdev)],exp:call[exp:ident(bdev_get_kobj),exp:ident(bdev)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(sdev)],stmt:goto(fail_put_hdev),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:call[exp:ident(bdev_get_holder),exp:ident(bdev)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(hdir)],stmt:goto(fail_put_sdev),stmt:exprstmt(none)],stmt:return:exp:const:int(1),statem(N/H),statem(N/H),statem(N/H),stmt:return:exp:const:int(0)]],def[fname(bd_holder_release_dirs),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(hdir)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(hdev)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(sdir)]]]],def[fname(alloc_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:call[exp:ident(kzalloc),exp:sizeof:exp:*ref:exp:ident(bo),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:ident(bo),stmt:return:exp:ident(NULL),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(count)],exp:const:int(1)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:ident(kobj)],stmt:return:exp:ident(bo)]],def[fname(free_bd_holder),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(bo)]]],def[fname(find_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:macroit:list_for_each_entry[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(tmp),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdir)]],stmt:comp{}[stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(tmp),ident(count)],stmt:return:exp:ident(tmp)],stmt:exprstmt(none)]],stmt:return:exp:ident(NULL)]],def[fname(add_bd_holder),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:ident(bo),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:!:exp:call[exp:ident(bd_holder_grab_dirs),exp:ident(bdev),exp:ident(bo)],stmt:return:exp:-:exp:ident(EBUSY),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]]],stmt:if[exp:ident(err),stmt:return:exp:ident(err),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_symlink),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:record_ptr[exp:ident(bo),ident(hdev)]]],stmt:if[exp:ident(err),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:return:exp:ident(err)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(list_add_tail),exp:&ref:exp:record_ptr[exp:ident(bo),ident(list)],exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_holder_list)]],stmt:return:exp:const:int(0)]],def[fname(del_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:macroit:list_for_each_entry[stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:ident(kobj)],stmt:comp{}[stmt:exprstmt:exp:postfix:--:exp:record_ptr[exp:ident(bo),ident(count)],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:binary_logi[logiop(<),exp:record_ptr[exp:ident(bo),ident(count)],exp:const:int(0)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(count)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(list_del),exp:&ref:exp:record_ptr[exp:ident(bo),ident(list)]],stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:record_ptr[exp:ident(bo),ident(hdev)]],stmt:exprstmt:exp:call[exp:ident(bd_holder_release_dirs),exp:ident(bo)],stmt:return:exp:ident(bo)],stmt:exprstmt(none)],stmt:jump(break)],stmt:exprstmt(none)]]],stmt:return:exp:ident(NULL)]],def[fname(bd_claim_by_kobject),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(holder),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(kobj),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:call[exp:ident(alloc_bd_holder),exp:ident(kobj)]],stmt:if[exp:!:exp:ident(bo),stmt:return:exp:-:exp:ident(ENOMEM),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(holder)]],stmt:if[exp:ident(err),stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(found),exp:call[exp:ident(find_bd_holder),exp:ident(bdev),exp:ident(bo)]],stmt:if[exp:ident(found),stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_bd_holder),exp:ident(bdev),exp:ident(bo)]],stmt:if[exp:ident(err),stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:ident(NULL)]],statem(N/H),stmt:exprstmt:exp:call[exp:ident(free_bd_holder),exp:ident(bo)],stmt:return:exp:ident(err)]],def[fname(bd_release_from_kobject),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:!:exp:ident(kobj),stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(free_bd_holder),exp:call[exp:ident(del_bd_holder),exp:ident(bdev),exp:ident(kobj)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]]]],def[fname(bd_claim_by_disk),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(holder),fulltype[typec(N/H)]],param[reg(),name(disk),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(bd_claim_by_kobject),exp:ident(bdev),exp:ident(holder),exp:call[exp:ident(kobject_get),exp:record_ptr[exp:ident(disk),ident(slave_dir)]]]]],mtop(N/H),def[fname(bd_release_from_disk),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(disk),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_release_from_kobject),exp:ident(bdev),exp:record_ptr[exp:ident(disk),ident(slave_dir)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(disk),ident(slave_dir)]]]],mtop(N/H),def[fname(open_by_devnum),funtype[fulltype[typec(N/H)],param[reg(),name(dev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(bdev),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(blkdev_get),exp:ident(bdev),exp:ident(mode),exp:ident(flags)]],stmt:exprstmt(none)],stmt:return:exp:cond3[exp:ident(err),exp:call[exp:ident(ERR_PTR),exp:ident(err)],exp:ident(bdev)]]],mtop(N/H),def[fname(check_disk_change),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(bdops),ident(media_changed)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:!:exp:call[exp:record_ptr[exp:ident(bdops),ident(media_changed)],exp:record_ptr[exp:ident(bdev),ident(bd_disk)]],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(__invalidate_device),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:string(VFS: busy inodes on changed media.\n)],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdops),ident(revalidate_disk)],stmt:exprstmt:exp:call[exp:record_ptr[exp:ident(bdops),ident(revalidate_disk)],exp:record_ptr[exp:ident(bdev),ident(bd_disk)]],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(>),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(minors)],exp:const:int(1)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],exp:const:int(1)],stmt:exprstmt(none)],stmt:return:exp:const:int(1)]],mtop(N/H),def[fname(bd_set_size),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_size)],exp:ident(size)],stmt:while[exp:binary_logi[logiop(<),exp:ident(bsize),exp:ident(PAGE_CACHE_SIZE)],stmt:comp{}[stmt:if[exp:binary_arith[aop(&),exp:ident(size),exp:ident(bsize)],stmt:jump(break),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(N/H),exp:ident(bsize),exp:const:int(1)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(bsize)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_blkbits)],exp:call[exp:ident(blksize_bits),exp:ident(bsize)]]]],mtop(N/H),decl(N/H),decl(N/H),def[fname(do_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(file),ident(f_mapping)],exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)]],stmt:exprstmt:exp:call[exp:ident(lock_kernel)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(disk),exp:call[exp:ident(get_gendisk),exp:record_ptr[exp:ident(bdev),ident(bd_dev)],exp:&ref:exp:ident(part)]],stmt:if[exp:!:exp:ident(disk),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:return:exp:ident(ret)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(owner),exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(owner)]],stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)],exp:ident(for_part)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(disk)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:if[exp:!:exp:ident(part),stmt:comp{}[stmt:decl(N/H),stmt:if[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(open)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(open)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(file)]],stmt:if[exp:ident(ret),stmt:goto(out_first),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_set_size),exp:ident(bdev),exp:binary_arith[aop(<<),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_capacity),exp:ident(disk)]],exp:const:int(9)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdi),exp:call[exp:ident(blk_get_backing_dev_info),exp:ident(bdev)]],stmt:if[exp:binary_logi[logiop(==),exp:ident(bdi),exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdi),exp:&ref:exp:ident(default_backing_dev_info)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:ident(bdi)]],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],stmt:exprstmt:exp:call[exp:ident(rescan_partitions),exp:ident(disk),exp:ident(bdev)],stmt:exprstmt(none)]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(whole),exp:call[exp:ident(bdget_disk),exp:ident(disk),exp:const:int(0)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENOMEM)],stmt:if[exp:!:exp:ident(whole),stmt:goto(out_first),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:ident(for_part)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(__blkdev_get),exp:ident(whole),exp:record_ptr[exp:ident(file),ident(f_mode)],exp:record_ptr[exp:ident(file),ident(f_flags)],exp:const:int(1)]],stmt:if[exp:ident(ret),stmt:goto(out_first),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(whole)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(p),exp:array_acc[exp:record_ptr[exp:ident(disk),ident(part)],exp:binary_arith[aop(-),exp:ident(part),exp:const:int(1)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(whole),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)]],stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(||),exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(disk),ident(flags)],exp:ident(GENHD_FL_UP)],exp:!:exp:ident(p)],exp:!:exp:record_ptr[exp:ident(p),ident(nr_sects)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENXIO)],stmt:goto(out_first)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:ident(p),ident(dev)],ident(kobj)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_part)],exp:ident(p)],stmt:exprstmt:exp:call[exp:ident(bd_set_size),exp:ident(bdev),exp:binary_arith[aop(<<),exp:cast[fulltype[typec(N/H)],exp:record_ptr[exp:ident(p),ident(nr_sects)]],exp:const:int(9)]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:if[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(fops)],ident(open)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(fops)],ident(open)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(file)]],stmt:if[exp:ident(ret),stmt:goto(out),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],stmt:exprstmt:exp:call[exp:ident(rescan_partitions),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(bdev)],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:if[exp:ident(for_part),stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(bdev),ident(bd_part_count)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:return:exp:const:int(0),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:&ref:exp:ident(default_backing_dev_info)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(bdev),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt:exp:call[exp:ident(__blkdev_put),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:const:int(1)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(NULL)],stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:if[exp:ident(ret),stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:exprstmt(none)],stmt:return:exp:ident(ret)]],def[fname(__blkdev_get),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_file),ident(f_mode)],exp:ident(mode)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_file),ident(f_flags)],exp:ident(flags)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_file),ident(f_path)],ident(dentry)],exp:&ref:exp:ident(fake_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_dentry),ident(d_inode)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)]],stmt:return:exp:call[exp:ident(do_open),exp:ident(bdev),exp:&ref:exp:ident(fake_file),exp:ident(for_part)]]],def[fname(blkdev_get),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(__blkdev_get),exp:ident(bdev),exp:ident(mode),exp:ident(flags),exp:const:int(0)]]],mtop(N/H),def[fname(blkdev_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(filp),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(filp),ident(f_flags)],exp:ident(O_LARGEFILE)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:binary_logi[logiop(==),exp:ident(bdev),exp:ident(NULL)],stmt:return:exp:-:exp:ident(ENOMEM),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(do_open),exp:ident(bdev),exp:ident(filp),exp:const:int(0)]],stmt:if[exp:ident(res),stmt:return:exp:ident(res),stmt:exprstmt(none)],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(filp),ident(f_flags)],exp:ident(O_EXCL)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:!:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(filp)]],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(blkdev_put),exp:ident(bdev)],stmt:return:exp:ident(res)]],def[fname(__blkdev_put),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)],exp:ident(for_part)],stmt:exprstmt:exp:call[exp:ident(lock_kernel)],stmt:if[exp:ident(for_part),stmt:exprstmt:exp:postfix:--:exp:record_ptr[exp:ident(bdev),ident(bd_part_count)],stmt:exprstmt(none)],stmt:if[exp:!:exp:infix:--:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(sync_blockdev),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(kill_bdev),exp:ident(bdev)]],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:if[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(release)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(release)],exp:ident(bd_inode),exp:ident(NULL)]],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(dev)],ident(kobj)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_part)],exp:ident(NULL)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:&ref:exp:ident(default_backing_dev_info)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(bdev),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(victim),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(NULL)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:if[exp:ident(victim),stmt:exprstmt:exp:call[exp:ident(__blkdev_put),exp:ident(victim),exp:const:int(1)],stmt:exprstmt(none)],stmt:return:exp:ident(ret)]],def[fname(blkdev_put),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(__blkdev_put),exp:ident(bdev),exp:const:int(0)]]],mtop(N/H),def[fname(blkdev_close),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(filp),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_holder)],exp:ident(filp)],stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(blkdev_put),exp:ident(bdev)]]],def[fname(block_ioctl),funtype[fulltype[ctype[btype[itype[sgn(signed),base(long)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(cmd),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(arg),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(blkdev_ioctl),exp:record_ptr[exp:record_ptr[exp:ident(file),ident(f_mapping)],ident(host)],exp:ident(file),exp:ident(cmd),exp:ident(arg)]]],decl(N/H),decl(N/H),def[fname(ioctl_by_bdev),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(cmd),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(arg),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(set_fs),exp:ident(KERNEL_DS)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(blkdev_ioctl),exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(NULL),exp:ident(cmd),exp:ident(arg)]],stmt:exprstmt:exp:call[exp:ident(set_fs),exp:ident(old_fs)],stmt:return:exp:ident(res)]],mtop(N/H),def[fname(lookup_bdev),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)]],def[fname(open_bdev_excl),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(holder),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(lookup_bdev),exp:ident(path)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(bdev)],stmt:return:exp:ident(bdev),stmt:exprstmt(none)],stmt:if[exp:!:exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_RDONLY)],stmt:exprstmt:exp:assign[op_assi(|=),exp:ident(mode),exp:ident(FMODE_WRITE)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(blkdev_get),exp:ident(bdev),exp:ident(mode),exp:const:int(0)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_logi[logiop(&&),exp:!:exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_RDONLY)],exp:call[exp:ident(bdev_read_only),exp:ident(bdev)]],stmt:goto(blkdev_put),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(holder)]],stmt:if[exp:ident(error),stmt:goto(blkdev_put),stmt:exprstmt(none)],stmt:return:exp:ident(bdev),statem(N/H),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)]]],mtop(N/H),def[fname(close_bdev_excl),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(blkdev_put),exp:ident(bdev)]]],mtop(N/H),def[fname(__invalidate_device),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(sb),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(shrink_dcache_sb),exp:ident(sb)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(invalidate_inodes),exp:ident(sb)]],stmt:exprstmt:exp:call[exp:ident(drop_super),exp:ident(sb)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(invalidate_bdev),exp:ident(bdev)],stmt:return:exp:ident(res)]],mtop(N/H)] ==> prg2[includeN[inc_elem(linux),inc_elem(init.h)],includeN[inc_elem(linux),inc_elem(mm.h)],includeN[inc_elem(linux),inc_elem(fcntl.h)],includeN[inc_elem(linux),inc_elem(slab.h)],includeN[inc_elem(linux),inc_elem(kmod.h)],includeN[inc_elem(linux),inc_elem(major.h)],includeN[inc_elem(linux),inc_elem(smp_lock.h)],includeN[inc_elem(linux),inc_elem(highmem.h)],includeN[inc_elem(linux),inc_elem(blkdev.h)],includeN[inc_elem(linux),inc_elem(module.h)],includeN[inc_elem(linux),inc_elem(blkpg.h)],includeN[inc_elem(linux),inc_elem(buffer_head.h)],includeN[inc_elem(linux),inc_elem(writeback.h)],includeN[inc_elem(linux),inc_elem(mpage.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(uio.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(log2.h)],includeN[inc_elem(asm),inc_elem(uaccess.h)],includeL[inc_elem(internal.h)],decl(N/H),def[fname(BDEV_I),funtype[fulltype[typec(N/H)],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(container_of),exp:ident(inode),argtype(N/H),exp:ident(vfs_inode)]]],def[fname(I_BDEV),funtype[fulltype[typec(N/H)],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:&ref:exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)]]],mtop(N/H),def[fname(max_block),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(sz),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:binary_arith[aop(>>),exp:ident(sz),exp:ident(sizebits)]]],stmt:exprstmt(none)],stmt:return:exp:ident(retval)]],def[fname(kill_bdev),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)],ident(nrpages)],exp:const:int(0)],stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(invalidate_bh_lrus)],stmt:exprstmt:exp:call[exp:ident(truncate_inode_pages),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)],exp:const:int(0)]]],def[fname(set_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(||),exp:binary_logi[logiop(>),exp:ident(size),exp:ident(PAGE_SIZE)],exp:binary_logi[logiop(<),exp:ident(size),exp:const:int(512)]],exp:!:exp:call[exp:ident(is_power_of_2),exp:ident(size)]],stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(<),exp:ident(size),exp:call[exp:ident(bdev_hardsect_size),exp:ident(bdev)]],stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(size)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(sync_blockdev),exp:ident(bdev)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_blkbits)],exp:call[exp:ident(blksize_bits),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(kill_bdev),exp:ident(bdev)]],stmt:exprstmt(none)],stmt:return:exp:const:int(0)]],mtop(N/H),def[fname(sb_set_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:call[exp:ident(set_blocksize),exp:record_ptr[exp:ident(sb),ident(s_bdev)],exp:ident(size)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_blocksize)],exp:ident(size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_blocksize_bits)],exp:call[exp:ident(blksize_bits),exp:ident(size)]],stmt:return:exp:record_ptr[exp:ident(sb),ident(s_blocksize)]]],mtop(N/H),def[fname(sb_min_blocksize),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(<),exp:ident(size),exp:ident(minsize)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:ident(minsize)],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(sb_set_blocksize),exp:ident(sb),exp:ident(size)]]],mtop(N/H),def[fname(blkdev_get_block),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(iblock),fulltype[typec(N/H)]],param[reg(),name(bh),fulltype[typec(N/H)]],param[reg(),name(create),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(>=),exp:ident(iblock),exp:call[exp:ident(max_block),exp:call[exp:ident(I_BDEV),exp:ident(inode)]]],stmt:comp{}[stmt:if[exp:ident(create),stmt:return:exp:-:exp:ident(EIO),stmt:exprstmt(none)],stmt:return:exp:const:int(0)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_bdev)],exp:call[exp:ident(I_BDEV),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_blocknr)],exp:ident(iblock)],stmt:exprstmt:exp:call[exp:ident(set_buffer_mapped),exp:ident(bh)],stmt:return:exp:const:int(0)]],def[fname(blkdev_get_blocks),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(iblock),fulltype[typec(N/H)]],param[reg(),name(bh),fulltype[typec(N/H)]],param[reg(),name(create),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(>),exp:binary_arith[aop(+),exp:ident(iblock),exp:ident(max_blocks)],exp:ident(end_block)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(max_blocks),exp:binary_arith[aop(-),exp:ident(end_block),exp:ident(iblock)]],stmt:if[exp:binary_logi[logiop(<=),exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(long)]]]],exp:ident(max_blocks)],exp:const:int(0)],stmt:comp{}[stmt:if[exp:ident(create),stmt:return:exp:-:exp:ident(EIO),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(max_blocks),exp:const:int(0)]],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_bdev)],exp:call[exp:ident(I_BDEV),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_blocknr)],exp:ident(iblock)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bh),ident(b_size)],exp:binary_arith[aop(<<),exp:ident(max_blocks),exp:record_ptr[exp:ident(inode),ident(i_blkbits)]]],stmt:if[exp:ident(max_blocks),stmt:exprstmt:exp:call[exp:ident(set_buffer_mapped),exp:ident(bh)],stmt:exprstmt(none)],stmt:return:exp:const:int(0)]],def[fname(blkdev_direct_IO),funtype[fulltype[typec(N/H)],param[reg(),name(rw),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(iocb),fulltype[typec(N/H)]],param[reg(),name(iov),fulltype[typec(N/H)]],param[reg(),name(offset),fulltype[typec(N/H)]],param[reg(),name(nr_segs),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:return:exp:call[exp:ident(blockdev_direct_IO_no_locking),exp:ident(rw),exp:ident(iocb),exp:ident(inode),exp:call[exp:ident(I_BDEV),exp:ident(inode)],exp:ident(iov),exp:ident(offset),exp:ident(nr_segs),exp:ident(blkdev_get_blocks),exp:ident(NULL)]]],def[fname(blkdev_writepage),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(page),fulltype[typec(N/H)]],param[reg(),name(wbc),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(block_write_full_page),exp:ident(page),exp:ident(blkdev_get_block),exp:ident(wbc)]]],def[fname(blkdev_readpage),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(page),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(block_read_full_page),exp:ident(page),exp:ident(blkdev_get_block)]]],def[fname(blkdev_write_begin),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(mapping),fulltype[typec(N/H)]],param[reg(),name(pos),fulltype[typec(N/H)]],param[reg(),name(len),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(pagep),fulltype[typec(N/H)]],param[reg(),name(fsdata),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:*ref:exp:ident(pagep),exp:ident(NULL)],stmt:return:exp:call[exp:ident(block_write_begin),exp:ident(file),exp:ident(mapping),exp:ident(pos),exp:ident(len),exp:ident(flags),exp:ident(pagep),exp:ident(fsdata),exp:ident(blkdev_get_block)]]],def[fname(blkdev_write_end),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(mapping),fulltype[typec(N/H)]],param[reg(),name(pos),fulltype[typec(N/H)]],param[reg(),name(len),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(copied),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(page),fulltype[typec(N/H)]],param[reg(),name(fsdata),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(block_write_end),exp:ident(file),exp:ident(mapping),exp:ident(pos),exp:ident(len),exp:ident(copied),exp:ident(page),exp:ident(fsdata)]],stmt:exprstmt:exp:call[exp:ident(unlock_page),exp:ident(page)],stmt:exprstmt:exp:call[exp:ident(page_cache_release),exp:ident(page)],stmt:return:exp:ident(ret)]],def[fname(block_llseek),funtype[fulltype[typec(N/H)],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(offset),fulltype[typec(N/H)]],param[reg(),name(origin),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bd_inode),ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:call[exp:ident(i_size_read),exp:ident(bd_inode)]],stmt:switch[exp:ident(origin),stmt:comp{}[statem(N/H),stmt:jump(break),statem(N/H)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:-:exp:ident(EINVAL)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(>=),exp:ident(offset),exp:const:int(0)],exp:binary_logi[logiop(<=),exp:ident(offset),exp:ident(size)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:ident(offset),exp:record_ptr[exp:ident(file),ident(f_pos)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(file),ident(f_pos)],exp:ident(offset)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(retval),exp:ident(offset)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bd_inode),ident(i_mutex)]],stmt:return:exp:ident(retval)]],def[fname(block_fsync),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(filp),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(datasync),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(sync_blockdev),exp:call[exp:ident(I_BDEV),exp:record_ptr[exp:record_ptr[exp:ident(filp),ident(f_mapping)],ident(host)]]]]],decl(N/H),NCP(N/H),def[fname(bdev_alloc_inode),funtype[fulltype[typec(N/H)],param[reg(),name(sb),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:ident(ei),stmt:return:exp:ident(NULL),stmt:exprstmt(none)],stmt:return:exp:&ref:exp:record_ptr[exp:ident(ei),ident(vfs_inode)]]],def[fname(bdev_destroy_inode),funtype[fulltype[ctype[btype(void)]],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(bdi),ident(bdev)],ident(bd_inode_backing_dev_info)],exp:ident(NULL)],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(bdev_cachep),exp:ident(bdi)]]],def[fname(init_once),funtype[fulltype[ctype[btype(void)]],param[reg(),name(cachep),fulltype[typec(N/H)]],param[reg(),name(foo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(memset),exp:ident(bdev),exp:const:int(0),exp:sizeof:exp:*ref:exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(mutex_init),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(sema_init),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mount_sem)],exp:const:int(1)],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_inodes)]],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_list)]],stmt:exprstmt:exp:call[exp:ident(INIT_LIST_HEAD),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_holder_list)]],stmt:exprstmt:exp:call[exp:ident(inode_init_once),exp:&ref:exp:record_ptr[exp:ident(ei),ident(vfs_inode)]]]],def[fname(__bd_forget),funtype[fulltype[ctype[btype(void)]],param[reg(),name(inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(list_del_init),exp:&ref:exp:record_ptr[exp:ident(inode),ident(i_devices)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(inode),ident(i_bdev)],exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(inode),ident(i_mapping)],exp:&ref:exp:record_ptr[exp:ident(inode),ident(i_data)]]]],NCP(N/H),decl(N/H),def[fname(bd_get_sb),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(get_sb_pseudo),exp:ident(fs_type),exp:const:string(bdev:),exp:&ref:exp:ident(bdev_sops),exp:const:int(0x62646576),exp:ident(mnt)]]],decl(N/H),NCP(N/H),decl(N/H),NCP(N/H),def[fname(hash),funtype[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],param[reg(),name(dev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:binary_arith[aop(+),exp:call[exp:ident(MAJOR),exp:ident(dev)],exp:call[exp:ident(MINOR),exp:ident(dev)]]]],def[fname(bdev_test),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)],ident(bd_dev)],exp:*ref:exp:cast[fulltype[typec(N/H)],exp:ident(data)]]]],def[fname(bdev_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:call[exp:ident(BDEV_I),exp:ident(inode)],ident(bdev)],ident(bd_dev)],exp:*ref:exp:cast[fulltype[typec(N/H)],exp:ident(data)]],stmt:return:exp:const:int(0)]],decl(N/H),NCP(N/H),mtop(N/H),NCP(N/H),def[fname(bdput),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(iput),exp:record_ptr[exp:ident(bdev),ident(bd_inode)]]]],mtop(N/H),NCP(N/H),NCP(N/H),NCP(N/H),mtop(N/H),NCP(N/H),mtop(N/H),def[fname(bdev_get_kobj),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:return:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(dev)],ident(kobj)]],stmt:return:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(dev)],ident(kobj)]]]]],def[fname(bdev_get_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:return:exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(holder_dir)]],stmt:return:exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(holder_dir)]]]]],def[fname(add_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(from),fulltype[typec(N/H)]],param[reg(),name(to),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(from),exp:!:exp:ident(to)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(sysfs_create_link),exp:ident(from),exp:ident(to),exp:call[exp:ident(kobject_name),exp:ident(to)]]]],def[fname(del_symlink),funtype[fulltype[ctype[btype(void)]],param[reg(),name(from),fulltype[typec(N/H)]],param[reg(),name(to),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(from),exp:!:exp:ident(to)],stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(sysfs_remove_link),exp:ident(from),exp:call[exp:ident(kobject_name),exp:ident(to)]]]],decl(N/H),def[fname(bd_holder_grab_dirs),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(bdev),exp:!:exp:ident(bo)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:call[exp:ident(kobject_get),exp:record_ptr[exp:ident(bo),ident(sdir)]]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(sdir)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(hdev)],exp:call[exp:ident(kobject_get),exp:record_ptr[exp:record_ptr[exp:ident(bo),ident(sdir)],ident(parent)]]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(hdev)],stmt:goto(fail_put_sdir),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdev)],exp:call[exp:ident(bdev_get_kobj),exp:ident(bdev)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(sdev)],stmt:goto(fail_put_hdev),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:call[exp:ident(bdev_get_holder),exp:ident(bdev)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(hdir)],stmt:goto(fail_put_sdev),stmt:exprstmt(none)],stmt:return:exp:const:int(1),statem(N/H),statem(N/H),statem(N/H),stmt:return:exp:const:int(0)]],def[fname(bd_holder_release_dirs),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(hdir)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(hdev)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(bo),ident(sdir)]]]],def[fname(alloc_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:call[exp:ident(kzalloc),exp:sizeof:exp:*ref:exp:ident(bo),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:ident(bo),stmt:return:exp:ident(NULL),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(count)],exp:const:int(1)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:ident(kobj)],stmt:return:exp:ident(bo)]],def[fname(free_bd_holder),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(bo)]]],def[fname(find_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:macroit:list_for_each_entry[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(tmp),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdir)]],stmt:comp{}[stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(tmp),ident(count)],stmt:return:exp:ident(tmp)],stmt:exprstmt(none)]],stmt:return:exp:ident(NULL)]],def[fname(add_bd_holder),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(bo),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:ident(bo),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:if[exp:!:exp:call[exp:ident(bd_holder_grab_dirs),exp:ident(bdev),exp:ident(bo)],stmt:return:exp:-:exp:ident(EBUSY),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]]],stmt:if[exp:ident(err),stmt:return:exp:ident(err),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_symlink),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:record_ptr[exp:ident(bo),ident(hdev)]]],stmt:if[exp:ident(err),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:return:exp:ident(err)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(list_add_tail),exp:&ref:exp:record_ptr[exp:ident(bo),ident(list)],exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_holder_list)]],stmt:return:exp:const:int(0)]],def[fname(del_bd_holder),funtype[fulltype[typec(N/H)],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:macroit:list_for_each_entry[stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:ident(kobj)],stmt:comp{}[stmt:exprstmt:exp:postfix:--:exp:record_ptr[exp:ident(bo),ident(count)],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:binary_logi[logiop(<),exp:record_ptr[exp:ident(bo),ident(count)],exp:const:int(0)]],stmt:if[exp:!:exp:record_ptr[exp:ident(bo),ident(count)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(list_del),exp:&ref:exp:record_ptr[exp:ident(bo),ident(list)]],stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(sdir)],exp:record_ptr[exp:ident(bo),ident(sdev)]],stmt:exprstmt:exp:call[exp:ident(del_symlink),exp:record_ptr[exp:ident(bo),ident(hdir)],exp:record_ptr[exp:ident(bo),ident(hdev)]],stmt:exprstmt:exp:call[exp:ident(bd_holder_release_dirs),exp:ident(bo)],stmt:return:exp:ident(bo)],stmt:exprstmt(none)],stmt:jump(break)],stmt:exprstmt(none)]]],stmt:return:exp:ident(NULL)]],def[fname(bd_claim_by_kobject),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(holder),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(kobj),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:call[exp:ident(alloc_bd_holder),exp:ident(kobj)]],stmt:if[exp:!:exp:ident(bo),stmt:return:exp:-:exp:ident(ENOMEM),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(holder)]],stmt:if[exp:ident(err),stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(found),exp:call[exp:ident(find_bd_holder),exp:ident(bdev),exp:ident(bo)]],stmt:if[exp:ident(found),stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(add_bd_holder),exp:ident(bdev),exp:ident(bo)]],stmt:if[exp:ident(err),stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bo),exp:ident(NULL)]],statem(N/H),stmt:exprstmt:exp:call[exp:ident(free_bd_holder),exp:ident(bo)],stmt:return:exp:ident(err)]],def[fname(bd_release_from_kobject),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(kobj),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:!:exp:ident(kobj),stmt:jump(return),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(free_bd_holder),exp:call[exp:ident(del_bd_holder),exp:ident(bdev),exp:ident(kobj)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]]]],def[fname(bd_claim_by_disk),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(holder),fulltype[typec(N/H)]],param[reg(),name(disk),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(bd_claim_by_kobject),exp:ident(bdev),exp:ident(holder),exp:call[exp:ident(kobject_get),exp:record_ptr[exp:ident(disk),ident(slave_dir)]]]]],mtop(N/H),def[fname(bd_release_from_disk),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(disk),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_release_from_kobject),exp:ident(bdev),exp:record_ptr[exp:ident(disk),ident(slave_dir)]],stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:record_ptr[exp:ident(disk),ident(slave_dir)]]]],mtop(N/H),def[fname(open_by_devnum),funtype[fulltype[typec(N/H)],param[reg(),name(dev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(bdev),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(blkdev_get),exp:ident(bdev),exp:ident(mode),exp:ident(flags)]],stmt:exprstmt(none)],stmt:return:exp:cond3[exp:ident(err),exp:call[exp:ident(ERR_PTR),exp:ident(err)],exp:ident(bdev)]]],mtop(N/H),def[fname(check_disk_change),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(bdops),ident(media_changed)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:!:exp:call[exp:record_ptr[exp:ident(bdops),ident(media_changed)],exp:record_ptr[exp:ident(bdev),ident(bd_disk)]],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(__invalidate_device),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:string(VFS: busy inodes on changed media.\n)],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdops),ident(revalidate_disk)],stmt:exprstmt:exp:call[exp:record_ptr[exp:ident(bdops),ident(revalidate_disk)],exp:record_ptr[exp:ident(bdev),ident(bd_disk)]],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(>),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(minors)],exp:const:int(1)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],exp:const:int(1)],stmt:exprstmt(none)],stmt:return:exp:const:int(1)]],mtop(N/H),def[fname(bd_set_size),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_size)],exp:ident(size)],stmt:while[exp:binary_logi[logiop(<),exp:ident(bsize),exp:ident(PAGE_CACHE_SIZE)],stmt:comp{}[stmt:if[exp:binary_arith[aop(&),exp:ident(size),exp:ident(bsize)],stmt:jump(break),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(N/H),exp:ident(bsize),exp:const:int(1)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_block_size)],exp:ident(bsize)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_blkbits)],exp:call[exp:ident(blksize_bits),exp:ident(bsize)]]]],mtop(N/H),decl(N/H),decl(N/H),def[fname(do_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(file),ident(f_mapping)],exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_mapping)]],stmt:exprstmt:exp:call[exp:ident(lock_kernel)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(disk),exp:call[exp:ident(get_gendisk),exp:record_ptr[exp:ident(bdev),ident(bd_dev)],exp:&ref:exp:ident(part)]],stmt:if[exp:!:exp:ident(disk),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:return:exp:ident(ret)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(owner),exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(owner)]],stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)],exp:ident(for_part)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(disk)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:if[exp:!:exp:ident(part),stmt:comp{}[stmt:decl(N/H),stmt:if[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(open)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(open)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(file)]],stmt:if[exp:ident(ret),stmt:goto(out_first),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_set_size),exp:ident(bdev),exp:binary_arith[aop(<<),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_capacity),exp:ident(disk)]],exp:const:int(9)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdi),exp:call[exp:ident(blk_get_backing_dev_info),exp:ident(bdev)]],stmt:if[exp:binary_logi[logiop(==),exp:ident(bdi),exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdi),exp:&ref:exp:ident(default_backing_dev_info)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:ident(bdi)]],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],stmt:exprstmt:exp:call[exp:ident(rescan_partitions),exp:ident(disk),exp:ident(bdev)],stmt:exprstmt(none)]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(whole),exp:call[exp:ident(bdget_disk),exp:ident(disk),exp:const:int(0)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENOMEM)],stmt:if[exp:!:exp:ident(whole),stmt:goto(out_first),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:ident(for_part)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(__blkdev_get),exp:ident(whole),exp:record_ptr[exp:ident(file),ident(f_mode)],exp:record_ptr[exp:ident(file),ident(f_flags)],exp:const:int(1)]],stmt:if[exp:ident(ret),stmt:goto(out_first),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(whole)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(p),exp:array_acc[exp:record_ptr[exp:ident(disk),ident(part)],exp:binary_arith[aop(-),exp:ident(part),exp:const:int(1)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(whole),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)]],stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(||),exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(disk),ident(flags)],exp:ident(GENHD_FL_UP)],exp:!:exp:ident(p)],exp:!:exp:record_ptr[exp:ident(p),ident(nr_sects)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENXIO)],stmt:goto(out_first)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(kobject_get),exp:&ref:exp:record_acc[exp:record_ptr[exp:ident(p),ident(dev)],ident(kobj)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_part)],exp:ident(p)],stmt:exprstmt:exp:call[exp:ident(bd_set_size),exp:ident(bdev),exp:binary_arith[aop(<<),exp:cast[fulltype[typec(N/H)],exp:record_ptr[exp:ident(p),ident(nr_sects)]],exp:const:int(9)]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:if[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(fops)],ident(open)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_disk)],ident(fops)],ident(open)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(file)]],stmt:if[exp:ident(ret),stmt:goto(out),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(bdev),ident(bd_invalidated)],stmt:exprstmt:exp:call[exp:ident(rescan_partitions),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(bdev)],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:if[exp:ident(for_part),stmt:exprstmt:exp:postfix:++:exp:record_ptr[exp:ident(bdev),ident(bd_part_count)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:return:exp:const:int(0),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:&ref:exp:ident(default_backing_dev_info)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(bdev),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt:exp:call[exp:ident(__blkdev_put),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:const:int(1)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(NULL)],stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:if[exp:ident(ret),stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:exprstmt(none)],stmt:return:exp:ident(ret)]],def[fname(__blkdev_get),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_file),ident(f_mode)],exp:ident(mode)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_file),ident(f_flags)],exp:ident(flags)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_file),ident(f_path)],ident(dentry)],exp:&ref:exp:ident(fake_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:ident(fake_dentry),ident(d_inode)],exp:record_ptr[exp:ident(bdev),ident(bd_inode)]],stmt:return:exp:call[exp:ident(do_open),exp:ident(bdev),exp:&ref:exp:ident(fake_file),exp:ident(for_part)]]],def[fname(blkdev_get),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(__blkdev_get),exp:ident(bdev),exp:ident(mode),exp:ident(flags),exp:const:int(0)]]],mtop(N/H),def[fname(blkdev_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(filp),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(filp),ident(f_flags)],exp:ident(O_LARGEFILE)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:binary_logi[logiop(==),exp:ident(bdev),exp:ident(NULL)],stmt:return:exp:-:exp:ident(ENOMEM),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(do_open),exp:ident(bdev),exp:ident(filp),exp:const:int(0)]],stmt:if[exp:ident(res),stmt:return:exp:ident(res),stmt:exprstmt(none)],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(filp),ident(f_flags)],exp:ident(O_EXCL)],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:if[exp:!:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(filp)]],stmt:return:exp:const:int(0),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(blkdev_put),exp:ident(bdev)],stmt:return:exp:ident(res)]],def[fname(__blkdev_put),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(for_part),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)],exp:ident(for_part)],stmt:exprstmt:exp:call[exp:ident(lock_kernel)],stmt:if[exp:ident(for_part),stmt:exprstmt:exp:postfix:--:exp:record_ptr[exp:ident(bdev),ident(bd_part_count)],stmt:exprstmt(none)],stmt:if[exp:!:exp:infix:--:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(sync_blockdev),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(kill_bdev),exp:ident(bdev)]],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:if[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(release)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:record_ptr[exp:record_ptr[exp:ident(disk),ident(fops)],ident(release)],exp:ident(bd_inode),exp:ident(NULL)]],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:!:exp:record_ptr[exp:ident(bdev),ident(bd_openers)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(put_disk),exp:ident(disk)],stmt:exprstmt:exp:call[exp:ident(module_put),exp:ident(owner)],stmt:if[exp:binary_logi[logiop(!=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(bdev)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kobject_put),exp:&ref:exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_part)],ident(dev)],ident(kobj)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_part)],exp:ident(NULL)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_disk)],exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(bdev),ident(bd_inode)],ident(i_data)],ident(backing_dev_info)],exp:&ref:exp:ident(default_backing_dev_info)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(bdev),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(victim),exp:record_ptr[exp:ident(bdev),ident(bd_contains)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(bdev),ident(bd_contains)],exp:ident(NULL)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(unlock_kernel)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(bdev),ident(bd_mutex)]],stmt:exprstmt:exp:call[exp:ident(bdput),exp:ident(bdev)],stmt:if[exp:ident(victim),stmt:exprstmt:exp:call[exp:ident(__blkdev_put),exp:ident(victim),exp:const:int(1)],stmt:exprstmt(none)],stmt:return:exp:ident(ret)]],def[fname(blkdev_put),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(__blkdev_put),exp:ident(bdev),exp:const:int(0)]]],mtop(N/H),def[fname(blkdev_close),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(filp),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(bdev),ident(bd_holder)],exp:ident(filp)],stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(blkdev_put),exp:ident(bdev)]]],def[fname(block_ioctl),funtype[fulltype[ctype[btype[itype[sgn(signed),base(long)]]]],param[reg(),name(file),fulltype[typec(N/H)]],param[reg(),name(cmd),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(arg),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:return:exp:call[exp:ident(blkdev_ioctl),exp:record_ptr[exp:record_ptr[exp:ident(file),ident(f_mapping)],ident(host)],exp:ident(file),exp:ident(cmd),exp:ident(arg)]]],decl(N/H),decl(N/H),def[fname(ioctl_by_bdev),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]],param[reg(),name(cmd),fulltype[ctype[btype[itype[sgn(unsigned),base(int)]]]]],param[reg(),name(arg),fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(set_fs),exp:ident(KERNEL_DS)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(blkdev_ioctl),exp:record_ptr[exp:ident(bdev),ident(bd_inode)],exp:ident(NULL),exp:ident(cmd),exp:ident(arg)]],stmt:exprstmt:exp:call[exp:ident(set_fs),exp:ident(old_fs)],stmt:return:exp:ident(res)]],mtop(N/H),def[fname(lookup_bdev),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(||),exp:!:exp:ident(path),exp:!:exp:*ref:exp:ident(path)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EINVAL)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(path_lookup),exp:ident(path),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOTBLK)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:ident(inode),ident(i_mode)]],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:goto(fail),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(bd_acquire),exp:ident(inode)]],stmt:if[exp:!:exp:ident(bdev),stmt:goto(fail),stmt:exprstmt(none)],statem(N/H),stmt:return:exp:ident(bdev),statem(N/H),stmt:goto(out)]],def[fname(open_bdev_excl),funtype[fulltype[typec(N/H)],param[reg(),name(path),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(holder),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(bdev),exp:call[exp:ident(lookup_bdev),exp:ident(path)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(bdev)],stmt:return:exp:ident(bdev),stmt:exprstmt(none)],stmt:if[exp:!:exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_RDONLY)],stmt:exprstmt:exp:assign[op_assi(|=),exp:ident(mode),exp:ident(FMODE_WRITE)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(blkdev_get),exp:ident(bdev),exp:ident(mode),exp:const:int(0)]],stmt:if[exp:ident(error),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:-:exp:ident(EACCES)],stmt:if[exp:binary_logi[logiop(&&),exp:!:exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_RDONLY)],exp:call[exp:ident(bdev_read_only),exp:ident(bdev)]],stmt:goto(blkdev_put),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(error),exp:call[exp:ident(bd_claim),exp:ident(bdev),exp:ident(holder)]],stmt:if[exp:ident(error),stmt:goto(blkdev_put),stmt:exprstmt(none)],stmt:return:exp:ident(bdev),statem(N/H),stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(error)]]],mtop(N/H),def[fname(close_bdev_excl),funtype[fulltype[ctype[btype(void)]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(bd_release),exp:ident(bdev)],stmt:exprstmt:exp:call[exp:ident(blkdev_put),exp:ident(bdev)]]],mtop(N/H),def[fname(__invalidate_device),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(bdev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:ident(sb),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(shrink_dcache_sb),exp:ident(sb)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(res),exp:call[exp:ident(invalidate_inodes),exp:ident(sb)]],stmt:exprstmt:exp:call[exp:ident(drop_super),exp:ident(sb)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(invalidate_bdev),exp:ident(bdev)],stmt:return:exp:ident(res)]],mtop(N/H)]

  
stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],exp:call[meta(X3),exp:record_ptr[meta(X4),meta(X5)]]] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],exp:call[meta(X3),exp:record_ptr[meta(X4),meta(X5)]]]

stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],exp:call[meta(X3),meta(X4)]] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],exp:call[meta(X3),meta(X4)]]

stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],meta(X3)] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],meta(X3)]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],exp:call[meta(X2),exp:record_ptr[meta(X3),meta(X4)]]] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],exp:call[meta(X2),exp:record_ptr[meta(X3),meta(X4)]]]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],exp:call[meta(X2),meta(X3)]] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],exp:call[meta(X2),meta(X3)]]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],meta(X2)] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],meta(X2)]

stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],meta(X3)] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],meta(X3)]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],meta(X2)] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],meta(X2)]

stmt:exprstmt:exp:call[meta(X0),exp:record_ptr[meta(X1),meta(X2)]] ==> stmt:exprstmt:exp:call[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)]]

stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)] ==> stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]

stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]] ==> stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]]

stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],exp:call[meta(X3),meta(X4)]] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],exp:call[meta(X3),meta(X4)]]

stmt:exprstmt:exp:assign[meta(X0),exp:record_ptr[meta(X1),meta(X2)],meta(X3)] ==> stmt:exprstmt:exp:assign[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)],meta(X3)]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],exp:call[meta(X2),meta(X3)]] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],exp:call[meta(X2),meta(X3)]]

stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[meta(X0),meta(X1)],meta(X2)] ==> stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[meta(X0),ident(path)],meta(X1)],meta(X2)]

stmt:exprstmt:exp:call[meta(X0),exp:record_ptr[meta(X1),meta(X2)]] ==> stmt:exprstmt:exp:call[meta(X0),exp:record_acc[exp:record_ptr[meta(X1),ident(path)],meta(X2)]]

stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(dentry)],ident(d_name)],ident(name)]] ==> stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],ident(d_name)],ident(name)]]

stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]] ==> stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]]

def[fname(afs_mntpt_follow_link),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]]] ==> def[fname(afs_mntpt_follow_link),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]]]

prg2[includeN[inc_elem(linux),inc_elem(kernel.h)],includeN[inc_elem(linux),inc_elem(module.h)],includeN[inc_elem(linux),inc_elem(init.h)],includeN[inc_elem(linux),inc_elem(slab.h)],includeN[inc_elem(linux),inc_elem(fs.h)],includeN[inc_elem(linux),inc_elem(pagemap.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(mnt_namespace.h)],includeL[inc_elem(internal.h)],decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),def[fname(afs_mntpt_check_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(vnode),fulltype[typec(N/H)]],param[reg(),name(key),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string({%x:%u,%u}),exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(vid)],exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(vnode)],exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(unique)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:call[exp:ident(read_mapping_page),exp:record_ptr[exp:call[exp:ident(AFS_VNODE_TO_I),exp:ident(vnode)],ident(i_mapping)],exp:const:int(0),exp:&ref:exp:ident(file)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(page)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(PTR_ERR),exp:ident(page)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EIO)],stmt:if[exp:call[exp:ident(PageError),exp:ident(page)],stmt:goto(out_free),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(buf),exp:call[exp:ident(kmap),exp:ident(page)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(status)],ident(size)]],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(symlink to %*.*s),exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],exp:ident(size)],exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],exp:ident(size)],exp:ident(buf)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(>),exp:ident(size),exp:const:int(2)],exp:binary_logi[logiop(||),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:const:int(0)],exp:conts:char(%)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:const:int(0)],exp:conts:char(#)]]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:binary_arith[aop(-),exp:ident(size),exp:const:int(1)]],exp:conts:char(.)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(symlink is a mountpoint)],stmt:exprstmt:exp:call[exp:ident(spin_lock),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(lock)]],stmt:exprstmt:exp:call[exp:ident(set_bit),exp:ident(AFS_VNODE_MOUNTPOINT),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(flags)]],stmt:exprstmt:exp:call[exp:ident(spin_unlock),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(lock)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:const:int(0)],stmt:exprstmt:exp:call[exp:ident(kunmap),exp:ident(page)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],def[fname(afs_mntpt_lookup),funtype[fulltype[typec(N/H)],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p,%p{%p{%s},%s}),exp:ident(dir),exp:ident(dentry),exp:record_ptr[exp:ident(dentry),ident(d_parent)],exp:cond3[exp:record_ptr[exp:ident(dentry),ident(d_parent)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_parent)],ident(d_name)],ident(name)],exp:cast[fulltype[typec(N/H)],exp:const:string()]],exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)]],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EREMOTE)]]],def[fname(afs_mntpt_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(file),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p,%p{%p{%s},%s}),exp:ident(inode),exp:ident(file),exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],exp:cond3[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],ident(d_name)],ident(name)],exp:cast[fulltype[typec(N/H)],exp:const:string()]],exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_name)],ident(name)]],stmt:return:exp:-:exp:ident(EREMOTE)]],def[fname(afs_mntpt_do_automount),funtype[fulltype[typec(N/H)],param[reg(),name(mntpt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string({%s}),exp:record_acc[exp:record_ptr[exp:ident(mntpt),ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:!:exp:record_ptr[exp:ident(mntpt),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:record_ptr[exp:record_ptr[exp:ident(mntpt),ident(d_inode)],ident(i_size)]],stmt:if[exp:binary_logi[logiop(>),exp:ident(size),exp:binary_arith[aop(-),exp:ident(PAGE_SIZE),exp:const:int(1)]],stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(devname),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_zeroed_page),exp:ident(GFP_KERNEL)]]],stmt:if[exp:!:exp:ident(devname),stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(options),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_zeroed_page),exp:ident(GFP_KERNEL)]]],stmt:if[exp:!:exp:ident(options),stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:call[exp:ident(read_mapping_page),exp:record_ptr[exp:record_ptr[exp:ident(mntpt),ident(d_inode)],ident(i_mapping)],exp:const:int(0),exp:ident(NULL)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(page)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(PTR_ERR),exp:ident(page)]],stmt:goto(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EIO)],stmt:if[exp:call[exp:ident(PageError),exp:ident(page)],stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(buf),exp:call[exp:ident(kmap),exp:ident(page)]],stmt:exprstmt:exp:call[exp:ident(memcpy),exp:ident(devname),exp:ident(buf),exp:ident(size)],stmt:exprstmt:exp:call[exp:ident(kunmap),exp:ident(page)],stmt:exprstmt:exp:call[exp:ident(page_cache_release),exp:ident(page)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(super),exp:call[exp:ident(AFS_FS_S),exp:record_ptr[exp:ident(mntpt),ident(d_sb)]]],stmt:exprstmt:exp:call[exp:ident(memcpy),exp:ident(options),exp:const:string(cell=),exp:const:int(5)],stmt:exprstmt:exp:call[exp:ident(strcpy),exp:binary_arith[aop(+),exp:ident(options),exp:const:int(5)],exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(super),ident(volume)],ident(cell)],ident(name)]],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:record_ptr[exp:ident(super),ident(volume)],ident(type)],exp:ident(AFSVL_RWVOL)],stmt:exprstmt:exp:call[exp:ident(strcat),exp:ident(options),exp:const:string(,rwpath)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(--- attempting mount %s -o %s ---),exp:ident(devname),exp:ident(options)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mnt),exp:call[exp:ident(vfs_kern_mount),exp:&ref:exp:ident(afs_fs_type),exp:const:int(0),exp:ident(devname),exp:ident(options)]],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(--- mount result %p ---),exp:ident(mnt)],stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(devname)]],stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(options)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %p),exp:ident(mnt)],stmt:return:exp:ident(mnt),statem(N/H),stmt:if[exp:ident(devname),stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(devname)]],stmt:exprstmt(none)],stmt:if[exp:ident(options),stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(options)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(ret)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(ret)]]],def[fname(afs_mntpt_follow_link),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(nd),ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]]],def[fname(afs_mntpt_expiry_timed_out),funtype[fulltype[ctype[btype(void)]],param[reg(),name(work),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string()],stmt:if[exp:!:exp:call[exp:ident(list_empty),exp:&ref:exp:ident(afs_vfsmounts)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mark_mounts_for_expiry),exp:&ref:exp:ident(afs_vfsmounts)],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string()]]],def[fname(afs_mntpt_kill_timer),funtype[fulltype[ctype[btype(void)]],param[reg(),name(),fulltype[ctype[btype(void)]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string()],stmt:exprstmt:exp:call[exp:ident(ASSERT),exp:call[exp:ident(list_empty),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:exprstmt:exp:call[exp:ident(cancel_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer)],stmt:exprstmt:exp:call[exp:ident(flush_scheduled_work)]]],def[fname(afs_umount_begin),funtype[fulltype[ctype[btype(void)]],param[reg(),name(vfsmnt),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(shrink_submounts),exp:ident(vfsmnt),exp:&ref:exp:ident(afs_vfsmounts)]]]] ==> prg2[includeN[inc_elem(linux),inc_elem(kernel.h)],includeN[inc_elem(linux),inc_elem(module.h)],includeN[inc_elem(linux),inc_elem(init.h)],includeN[inc_elem(linux),inc_elem(slab.h)],includeN[inc_elem(linux),inc_elem(fs.h)],includeN[inc_elem(linux),inc_elem(pagemap.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(mnt_namespace.h)],includeL[inc_elem(internal.h)],decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),decl(N/H),def[fname(afs_mntpt_check_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(vnode),fulltype[typec(N/H)]],param[reg(),name(key),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string({%x:%u,%u}),exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(vid)],exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(vnode)],exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(fid)],ident(unique)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:call[exp:ident(read_mapping_page),exp:record_ptr[exp:call[exp:ident(AFS_VNODE_TO_I),exp:ident(vnode)],ident(i_mapping)],exp:const:int(0),exp:&ref:exp:ident(file)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(page)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(PTR_ERR),exp:ident(page)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EIO)],stmt:if[exp:call[exp:ident(PageError),exp:ident(page)],stmt:goto(out_free),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(buf),exp:call[exp:ident(kmap),exp:ident(page)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:record_acc[exp:record_ptr[exp:ident(vnode),ident(status)],ident(size)]],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(symlink to %*.*s),exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],exp:ident(size)],exp:cast[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],exp:ident(size)],exp:ident(buf)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(>),exp:ident(size),exp:const:int(2)],exp:binary_logi[logiop(||),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:const:int(0)],exp:conts:char(%)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:const:int(0)],exp:conts:char(#)]]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(buf),exp:binary_arith[aop(-),exp:ident(size),exp:const:int(1)]],exp:conts:char(.)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(symlink is a mountpoint)],stmt:exprstmt:exp:call[exp:ident(spin_lock),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(lock)]],stmt:exprstmt:exp:call[exp:ident(set_bit),exp:ident(AFS_VNODE_MOUNTPOINT),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(flags)]],stmt:exprstmt:exp:call[exp:ident(spin_unlock),exp:&ref:exp:record_ptr[exp:ident(vnode),ident(lock)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:const:int(0)],stmt:exprstmt:exp:call[exp:ident(kunmap),exp:ident(page)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],def[fname(afs_mntpt_lookup),funtype[fulltype[typec(N/H)],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p,%p{%p{%s},%s}),exp:ident(dir),exp:ident(dentry),exp:record_ptr[exp:ident(dentry),ident(d_parent)],exp:cond3[exp:record_ptr[exp:ident(dentry),ident(d_parent)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_parent)],ident(d_name)],ident(name)],exp:cast[fulltype[typec(N/H)],exp:const:string()]],exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)]],stmt:return:exp:call[exp:ident(ERR_PTR),exp:-:exp:ident(EREMOTE)]]],def[fname(afs_mntpt_open),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(file),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p,%p{%p{%s},%s}),exp:ident(inode),exp:ident(file),exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],exp:cond3[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],exp:record_acc[exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_parent)],ident(d_name)],ident(name)],exp:cast[fulltype[typec(N/H)],exp:const:string()]],exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(file),ident(f_path)],ident(dentry)],ident(d_name)],ident(name)]],stmt:return:exp:-:exp:ident(EREMOTE)]],def[fname(afs_mntpt_do_automount),funtype[fulltype[typec(N/H)],param[reg(),name(mntpt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string({%s}),exp:record_acc[exp:record_ptr[exp:ident(mntpt),ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:!:exp:record_ptr[exp:ident(mntpt),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(size),exp:record_ptr[exp:record_ptr[exp:ident(mntpt),ident(d_inode)],ident(i_size)]],stmt:if[exp:binary_logi[logiop(>),exp:ident(size),exp:binary_arith[aop(-),exp:ident(PAGE_SIZE),exp:const:int(1)]],stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(devname),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_zeroed_page),exp:ident(GFP_KERNEL)]]],stmt:if[exp:!:exp:ident(devname),stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(options),exp:cast[fulltype[typec(N/H)],exp:call[exp:ident(get_zeroed_page),exp:ident(GFP_KERNEL)]]],stmt:if[exp:!:exp:ident(options),stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:call[exp:ident(read_mapping_page),exp:record_ptr[exp:record_ptr[exp:ident(mntpt),ident(d_inode)],ident(i_mapping)],exp:const:int(0),exp:ident(NULL)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(page)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(PTR_ERR),exp:ident(page)]],stmt:goto(error)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EIO)],stmt:if[exp:call[exp:ident(PageError),exp:ident(page)],stmt:goto(error),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(buf),exp:call[exp:ident(kmap),exp:ident(page)]],stmt:exprstmt:exp:call[exp:ident(memcpy),exp:ident(devname),exp:ident(buf),exp:ident(size)],stmt:exprstmt:exp:call[exp:ident(kunmap),exp:ident(page)],stmt:exprstmt:exp:call[exp:ident(page_cache_release),exp:ident(page)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page),exp:ident(NULL)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(super),exp:call[exp:ident(AFS_FS_S),exp:record_ptr[exp:ident(mntpt),ident(d_sb)]]],stmt:exprstmt:exp:call[exp:ident(memcpy),exp:ident(options),exp:const:string(cell=),exp:const:int(5)],stmt:exprstmt:exp:call[exp:ident(strcpy),exp:binary_arith[aop(+),exp:ident(options),exp:const:int(5)],exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(super),ident(volume)],ident(cell)],ident(name)]],stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:record_ptr[exp:ident(super),ident(volume)],ident(type)],exp:ident(AFSVL_RWVOL)],stmt:exprstmt:exp:call[exp:ident(strcat),exp:ident(options),exp:const:string(,rwpath)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(--- attempting mount %s -o %s ---),exp:ident(devname),exp:ident(options)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mnt),exp:call[exp:ident(vfs_kern_mount),exp:&ref:exp:ident(afs_fs_type),exp:const:int(0),exp:ident(devname),exp:ident(options)]],stmt:exprstmt:exp:call[exp:ident(_debug),exp:const:string(--- mount result %p ---),exp:ident(mnt)],stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(devname)]],stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(options)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %p),exp:ident(mnt)],stmt:return:exp:ident(mnt),statem(N/H),stmt:if[exp:ident(devname),stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(devname)]],stmt:exprstmt(none)],stmt:if[exp:ident(options),stmt:exprstmt:exp:call[exp:ident(free_page),exp:cast[fulltype[ctype[btype[itype[sgn(unsigned),base(long)]]]],exp:ident(options)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(ret)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(ret)]]],def[fname(afs_mntpt_follow_link),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string(%p{%s},{%s:%p{%s},}),exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_devname)],exp:ident(dentry),exp:record_acc[exp:record_ptr[exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],ident(d_name)],ident(name)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(newmnt),exp:call[exp:ident(afs_mntpt_do_automount),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(newmnt)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(path_release),exp:ident(nd)],stmt:return:exp:cast[fulltype[typec(N/H)],exp:ident(newmnt)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mntget),exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:call[exp:ident(do_add_mount),exp:ident(newmnt),exp:ident(nd),exp:ident(MNT_SHRINKABLE),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:switch[exp:ident(err),stmt:comp{}[statem(N/H),stmt:exprstmt:exp:call[exp:ident(mntput),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(newmnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(dget),exp:record_ptr[exp:ident(newmnt),ident(mnt_root)]]],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]],stmt:jump(break),statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(err),exp:const:int(0)],statem(N/H),stmt:jump(break)]],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string( = %d),exp:ident(err)],stmt:return:exp:call[exp:ident(ERR_PTR),exp:ident(err)]]],def[fname(afs_mntpt_expiry_timed_out),funtype[fulltype[ctype[btype(void)]],param[reg(),name(work),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string()],stmt:if[exp:!:exp:call[exp:ident(list_empty),exp:&ref:exp:ident(afs_vfsmounts)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mark_mounts_for_expiry),exp:&ref:exp:ident(afs_vfsmounts)],stmt:exprstmt:exp:call[exp:ident(schedule_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer),exp:binary_arith[aop(*),exp:ident(afs_mntpt_expiry_timeout),exp:ident(HZ)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(_leave),exp:const:string()]]],def[fname(afs_mntpt_kill_timer),funtype[fulltype[ctype[btype(void)]],param[reg(),name(),fulltype[ctype[btype(void)]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(_enter),exp:const:string()],stmt:exprstmt:exp:call[exp:ident(ASSERT),exp:call[exp:ident(list_empty),exp:&ref:exp:ident(afs_vfsmounts)]],stmt:exprstmt:exp:call[exp:ident(cancel_delayed_work),exp:&ref:exp:ident(afs_mntpt_expiry_timer)],stmt:exprstmt:exp:call[exp:ident(flush_scheduled_work)]]],def[fname(afs_umount_begin),funtype[fulltype[ctype[btype(void)]],param[reg(),name(vfsmnt),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(shrink_submounts),exp:ident(vfsmnt),exp:&ref:exp:ident(afs_vfsmounts)]]]]

  
exp:call[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)]] ==> exp:call[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)]]

stmt:exprstmt:exp:assign[meta(X0),meta(X1),exp:call[meta(X2),exp:record_ptr[exp:record_acc[meta(X3),meta(X4)],meta(X5)]]] ==> stmt:exprstmt:exp:assign[meta(X0),meta(X1),exp:call[meta(X2),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X3),ident(path)],meta(X4)],meta(X5)]]]

stmt:exprstmt:exp:assign[simple_assi(=),meta(X0),exp:call[meta(X1),exp:record_ptr[exp:record_acc[meta(X2),meta(X3)],meta(X4)]]] ==> stmt:exprstmt:exp:assign[simple_assi(=),meta(X0),exp:call[meta(X1),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X2),ident(path)],meta(X3)],meta(X4)]]]

exp:call[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)]] ==> exp:call[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)]]

exp:binary_logi[meta(X0),exp:call[meta(X1),exp:record_ptr[exp:record_acc[meta(X2),meta(X3)],meta(X4)]],meta(X5)] ==> exp:binary_logi[meta(X0),exp:call[meta(X1),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X2),ident(path)],meta(X3)],meta(X4)]],meta(X5)]

exp:record_acc[meta(X0),meta(X1)] ==> exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)]

exp:record_ptr[exp:record_acc[meta(X0),meta(X1)],meta(X2)] ==> exp:record_ptr[exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)],meta(X2)]

exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)],meta(X4)] ==> exp:binary_arith[meta(X0),exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)],meta(X4)]

stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)] ==> stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)]

exp:record_ptr[exp:record_ptr[exp:record_acc[meta(X0),meta(X1)],meta(X2)],meta(X3)] ==> exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)],meta(X2)],meta(X3)]

exp:!:exp:call[meta(X0),exp:record_ptr[exp:record_ptr[exp:record_acc[meta(X1),meta(X2)],meta(X3)],meta(X4)]] ==> exp:!:exp:call[meta(X0),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_acc[meta(X1),ident(path)],meta(X2)],meta(X3)],meta(X4)]]

exp:record_ptr[exp:record_acc[meta(X0),meta(X1)],meta(X2)] ==> exp:record_ptr[exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)],meta(X2)]

exp:record_acc[meta(X0),meta(X1)] ==> exp:record_acc[exp:record_acc[meta(X0),ident(path)],meta(X1)]

stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:ident(nd),ident(dentry)],exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],exp:ident(NULL)]] ==> stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],exp:ident(NULL)]]

stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:ident(nd),ident(dentry)],exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)] ==> stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]

def[fname(get_sb_mtd),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:ident(nd),ident(dentry)],exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]] ==> def[fname(get_sb_mtd),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]]

prg2[includeN[inc_elem(linux),inc_elem(mtd),inc_elem(super.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(ctype.h)],def[fname(get_sb_mtd_compare),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(_mtd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(mtd)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: Match on device %d (\"%s\")\n),exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:return:exp:const:int(1)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: No match, device %d (\"%s\"), device %d (\"%s\")\n),exp:record_ptr[exp:record_ptr[exp:ident(sb),ident(s_mtd)],ident(index)],exp:record_ptr[exp:record_ptr[exp:ident(sb),ident(s_mtd)],ident(name)],exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:return:exp:const:int(0)]],def[fname(get_sb_mtd_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(_mtd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(mtd)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_dev)],exp:call[exp:ident(MKDEV),exp:ident(MTD_BLOCK_MAJOR),exp:record_ptr[exp:ident(mtd),ident(index)]]],stmt:return:exp:const:int(0)]],def[fname(get_sb_mtd_aux),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mtd),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(sb),exp:call[exp:ident(sget),exp:ident(fs_type),exp:ident(get_sb_mtd_compare),exp:ident(get_sb_mtd_set),exp:ident(mtd)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(sb)],stmt:goto(out_error),stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(sb),ident(s_root)],stmt:goto(already_mounted),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: New superblock for device %d (\"%s\")\n),exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_flags)],exp:ident(flags)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(fill_super),exp:ident(sb),exp:ident(data),exp:cond3[exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_SILENT)],exp:const:int(1),exp:const:int(0)]]],stmt:if[exp:binary_logi[logiop(<),exp:ident(ret),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(up_write),exp:&ref:exp:record_ptr[exp:ident(sb),ident(s_umount)]],stmt:exprstmt:exp:call[exp:ident(deactivate_super),exp:ident(sb)],stmt:return:exp:ident(ret)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(sb),ident(s_flags)],exp:ident(MS_ACTIVE)],stmt:return:exp:call[exp:ident(simple_set_mnt),exp:ident(mnt),exp:ident(sb)],statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(simple_set_mnt),exp:ident(mnt),exp:ident(sb)]],stmt:goto(out_put),statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],def[fname(get_sb_mtd_nr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mtdnr),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(0),exp:const:string(MTDSB: Device #%u doesn't appear to exist\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(PTR_ERR),exp:ident(mtd)]],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)]]],def[fname(get_sb_mtd),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:ident(nd),ident(dentry)],exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:ident(nd),ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],mtop(N/H),def[fname(kill_mtd_super),funtype[fulltype[ctype[btype(void)]],param[reg(),name(sb),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(generic_shutdown_super),exp:ident(sb)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:record_ptr[exp:ident(sb),ident(s_mtd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(NULL)]]],mtop(N/H)] ==> prg2[includeN[inc_elem(linux),inc_elem(mtd),inc_elem(super.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(ctype.h)],def[fname(get_sb_mtd_compare),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(_mtd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:binary_logi[logiop(==),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(mtd)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: Match on device %d (\"%s\")\n),exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:return:exp:const:int(1)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: No match, device %d (\"%s\"), device %d (\"%s\")\n),exp:record_ptr[exp:record_ptr[exp:ident(sb),ident(s_mtd)],ident(index)],exp:record_ptr[exp:record_ptr[exp:ident(sb),ident(s_mtd)],ident(name)],exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:return:exp:const:int(0)]],def[fname(get_sb_mtd_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(sb),fulltype[typec(N/H)]],param[reg(),name(_mtd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(mtd)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_dev)],exp:call[exp:ident(MKDEV),exp:ident(MTD_BLOCK_MAJOR),exp:record_ptr[exp:ident(mtd),ident(index)]]],stmt:return:exp:const:int(0)]],def[fname(get_sb_mtd_aux),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mtd),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(sb),exp:call[exp:ident(sget),exp:ident(fs_type),exp:ident(get_sb_mtd_compare),exp:ident(get_sb_mtd_set),exp:ident(mtd)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(sb)],stmt:goto(out_error),stmt:exprstmt(none)],stmt:if[exp:record_ptr[exp:ident(sb),ident(s_root)],stmt:goto(already_mounted),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: New superblock for device %d (\"%s\")\n),exp:record_ptr[exp:ident(mtd),ident(index)],exp:record_ptr[exp:ident(mtd),ident(name)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_flags)],exp:ident(flags)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(fill_super),exp:ident(sb),exp:ident(data),exp:cond3[exp:binary_arith[aop(&),exp:ident(flags),exp:ident(MS_SILENT)],exp:const:int(1),exp:const:int(0)]]],stmt:if[exp:binary_logi[logiop(<),exp:ident(ret),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(up_write),exp:&ref:exp:record_ptr[exp:ident(sb),ident(s_umount)]],stmt:exprstmt:exp:call[exp:ident(deactivate_super),exp:ident(sb)],stmt:return:exp:ident(ret)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(sb),ident(s_flags)],exp:ident(MS_ACTIVE)],stmt:return:exp:call[exp:ident(simple_set_mnt),exp:ident(mnt),exp:ident(sb)],statem(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(simple_set_mnt),exp:ident(mnt),exp:ident(sb)]],stmt:goto(out_put),statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],def[fname(get_sb_mtd_nr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(mtdnr),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(0),exp:const:string(MTDSB: Device #%u doesn't appear to exist\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(PTR_ERR),exp:ident(mtd)]],stmt:exprstmt(none)],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)]]],def[fname(get_sb_mtd),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(fs_type),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev_name),fulltype[typec(N/H)]],param[reg(),name(data),fulltype[typec(N/H)]],param[reg(),name(fill_super),fulltype[typec(N/H)]],param[reg(),name(mnt),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:!:exp:ident(dev_name),stmt:return:exp:-:exp:ident(EINVAL),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(2),exp:const:string(MTDSB: dev_name \"%s\"\n),exp:ident(dev_name)],stmt:if[exp:binary_logi[logiop(&&),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(0)],exp:conts:char(m)],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(1)],exp:conts:char(t)]],exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(2)],exp:conts:char(d)]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:array_acc[exp:ident(dev_name),exp:const:int(3)],exp:conts:char(:)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd:%%s, name \"%s\"\n),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:for[exp:assign[simple_assi(=),exp:ident(mtdnr),exp:const:int(0)],exp:binary_logi[logiop(<),exp:ident(mtdnr),exp:ident(MAX_MTD_DEVICES)],exp:postfix:++:exp:ident(mtdnr),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtd),exp:call[exp:ident(get_mtd_device),exp:ident(NULL),exp:ident(mtdnr)]],stmt:if[exp:!:exp:call[exp:ident(IS_ERR),exp:ident(mtd)],stmt:comp{}[stmt:if[exp:!:exp:call[exp:ident(strcmp),exp:record_ptr[exp:ident(mtd),ident(name)],exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]],stmt:return:exp:call[exp:ident(get_sb_mtd_aux),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtd),exp:ident(fill_super),exp:ident(mnt)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:ident(mtd)]],stmt:exprstmt(none)]]],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(4)]]],stmt:if[exp:call[exp:ident(isdigit),exp:array_acc[exp:ident(dev_name),exp:const:int(3)]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(simple_strtoul),exp:binary_arith[aop(+),exp:ident(dev_name),exp:const:int(3)],exp:&ref:exp:ident(endptr),exp:const:int(0)]],stmt:if[exp:!:exp:*ref:exp:ident(endptr),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: mtd%%d, mtdnr %d\n),exp:ident(mtdnr)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)]],stmt:exprstmt(none)]],stmt:exprstmt(none)]]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:call[exp:ident(path_lookup),exp:ident(dev_name),exp:ident(LOOKUP_FOLLOW),exp:&ref:exp:ident(nd)]],stmt:exprstmt:exp:call[exp:ident(DEBUG),exp:const:int(1),exp:const:string(MTDSB: path_lookup() returned %d, inode %p\n),exp:ident(ret),exp:cond3[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],exp:ident(NULL)]],stmt:if[exp:ident(ret),stmt:return:exp:ident(ret),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EINVAL)],stmt:if[exp:!:exp:call[exp:ident(S_ISBLK),exp:record_ptr[exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)],ident(i_mode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(mnt)],ident(mnt_flags)],exp:ident(MNT_NODEV)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(ret),exp:-:exp:ident(EACCES)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:binary_logi[logiop(!=),exp:call[exp:ident(imajor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]],exp:ident(MTD_BLOCK_MAJOR)],stmt:goto(not_an_MTD_device),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mtdnr),exp:call[exp:ident(iminor),exp:record_ptr[exp:record_acc[exp:record_acc[exp:ident(nd),ident(path)],ident(dentry)],ident(d_inode)]]],stmt:exprstmt:exp:call[exp:ident(path_release),exp:&ref:exp:ident(nd)],stmt:return:exp:call[exp:ident(get_sb_mtd_nr),exp:ident(fs_type),exp:ident(flags),exp:ident(dev_name),exp:ident(data),exp:ident(mtdnr),exp:ident(fill_super),exp:ident(mnt)],statem(N/H),statem(N/H),stmt:return:exp:ident(ret)]],mtop(N/H),def[fname(kill_mtd_super),funtype[fulltype[ctype[btype(void)]],param[reg(),name(sb),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(generic_shutdown_super),exp:ident(sb)],stmt:exprstmt:exp:call[exp:ident(put_mtd_device),exp:record_ptr[exp:ident(sb),ident(s_mtd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(sb),ident(s_mtd)],exp:ident(NULL)]]],mtop(N/H)]

  
  
stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)]] ==> stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)]]

stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]] ==> stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]]

stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)] ==> stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)]

def[fname(ecryptfs_permission),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(mask),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)]] ==> def[fname(ecryptfs_permission),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(mask),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)]]

stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)] ==> stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)]

def[fname(ecryptfs_create_underlying_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(lower_dir_inode),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)]] ==> def[fname(ecryptfs_create_underlying_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(lower_dir_inode),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)]]

prg2[includeN[inc_elem(linux),inc_elem(file.h)],includeN[inc_elem(linux),inc_elem(vmalloc.h)],includeN[inc_elem(linux),inc_elem(pagemap.h)],includeN[inc_elem(linux),inc_elem(dcache.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(crypto.h)],includeN[inc_elem(linux),inc_elem(fs_stack.h)],includeL[inc_elem(ecryptfs_kernel.h)],def[fname(lock_parent),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dir),exp:call[exp:ident(dget),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]],stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(dir),ident(d_inode)],ident(i_mutex)],exp:ident(I_MUTEX_PARENT)],stmt:return:exp:ident(dir)]],def[fname(unlock_parent),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_parent)],ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]]],def[fname(unlock_dir),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dir),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(dir),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(dir)]]],def[fname(ecryptfs_create_underlying_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(lower_dir_inode),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_ptr[exp:ident(nd),ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_ptr[exp:ident(nd),ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_do_create),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(directory_inode),fulltype[typec(N/H)]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(ecryptfs_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:if[exp:call[exp:ident(unlikely),exp:call[exp:ident(IS_ERR),exp:ident(lower_dir_dentry)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(PTR_ERR),exp:ident(lower_dir_dentry)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_create_underlying_file),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(ecryptfs_dentry),exp:ident(mode),exp:ident(nd)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(__FUNCTION__),exp:ident(rc)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(ecryptfs_dentry),exp:record_ptr[exp:ident(directory_inode),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Failure in ecryptfs_interpose\n)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(directory_inode),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(directory_inode),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),statem(N/H)]],def[fname(grow_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(fake_file),exp:const:int(0),exp:sizeof:exp:ident(fake_file)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_file),ident(f_path)],ident(dentry)],exp:ident(ecryptfs_dentry)],stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(tmp_file_info),exp:const:int(0),exp:sizeof:exp:ident(tmp_file_info)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_private),exp:&ref:exp:ident(fake_file),exp:&ref:exp:ident(tmp_file_info)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_lower),exp:&ref:exp:ident(fake_file),exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:ident(ecryptfs_inode)],ident(lower_file)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_file),exp:ident(zero_virt),exp:const:int(0),exp:const:int(1)]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:ident(ecryptfs_inode),exp:const:int(0)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_inode_size_to_metadata),exp:ident(ecryptfs_inode)]],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_acc[exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:ident(ecryptfs_inode)],ident(crypt_stat)],ident(flags)],exp:ident(ECRYPTFS_NEW_FILE)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_initialize_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:record_ptr[exp:ident(ecryptfs_dentry),ident(d_inode)],ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(This is a directory\n)],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_NEW_FILE)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Initializing crypto context\n)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_new_file_context),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_metadata),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(grow_file),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:exprstmt(none)],statem(N/H)]],def[fname(ecryptfs_create),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(directory_inode),fulltype[typec(N/H)]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_do_create),exp:ident(directory_inode),exp:ident(ecryptfs_dentry),exp:ident(mode),exp:ident(nd)]],stmt:if[exp:call[exp:ident(unlikely),exp:ident(rc)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_WARNING),exp:const:other(N/H)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_initialize_file),exp:ident(ecryptfs_dentry)]],statem(N/H)]],def[fname(ecryptfs_lookup),funtype[fulltype[typec(N/H)],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dentry),ident(d_op)],exp:&ref:exp:ident(ecryptfs_dops)],stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:const:int(1)],exp:!:exp:call[exp:ident(strcmp),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:const:string(.)]],exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:const:int(2)],exp:!:exp:call[exp:ident(strcmp),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:const:string(..)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(encoded_namelen),exp:call[exp:ident(ecryptfs_encode_filename),exp:ident(crypt_stat),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:&ref:exp:ident(encoded_name)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(encoded_namelen),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:ident(encoded_namelen)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:ident(encoded_name),exp:ident(encoded_namelen)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(lookup_one_len),exp:ident(encoded_name),exp:ident(lower_dir_dentry),exp:binary_arith[aop(-),exp:ident(encoded_namelen),exp:const:int(1)]]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(encoded_name)],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(lower_dentry)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(ERR from lower_dentry\n)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(PTR_ERR),exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_mnt),exp:call[exp:ident(mntget),exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:ident(lower_dentry),exp:record_acc[exp:record_ptr[exp:ident(lower_dentry),ident(d_name)],ident(name)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_inode),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_atime),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:!:exp:call[exp:ident(atomic_read),exp:&ref:exp:record_ptr[exp:ident(lower_dentry),ident(d_count)]]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_private),exp:ident(dentry),exp:call[exp:ident(kmem_cache_alloc),exp:ident(ecryptfs_dentry_info_cache),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:call[exp:ident(ecryptfs_dentry_to_private),exp:ident(dentry)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_lower),exp:ident(dentry),exp:ident(lower_dentry)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_lower_mnt),exp:ident(dentry),exp:ident(lower_mnt)],stmt:if[exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(d_add),exp:ident(dentry),exp:ident(NULL)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(1)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Error interposing\n)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a directory; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(S_ISLNK),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a symlink; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(special_file),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a special file; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:!:exp:ident(nd),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page_virt),exp:call[exp:ident(kmem_cache_zalloc),exp:ident(ecryptfs_header_cache_2),exp:ident(GFP_USER)]],stmt:if[exp:!:exp:ident(page_virt),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Cannot ecryptfs_kmalloc a page\n)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_POLICY_APPLIED)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_default_sizes),exp:ident(crypt_stat)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_and_validate_header_region),exp:ident(page_virt),exp:record_ptr[exp:ident(dentry),ident(d_inode)]]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_and_validate_xattr_region),exp:ident(page_virt),exp:ident(dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:const:int(0)],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(ecryptfs_header_cache_2),exp:ident(page_virt)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_METADATA_IN_XATTR)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mount_crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_superblock_to_private),exp:record_ptr[exp:ident(dentry),ident(d_sb)]],ident(mount_crypt_stat)]],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(mount_crypt_stat),ident(flags)],exp:ident(ECRYPTFS_ENCRYPTED_VIEW_ENABLED)],stmt:comp{}[stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_METADATA_IN_XATTR)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:binary_arith[aop(+),exp:record_ptr[exp:ident(crypt_stat),ident(num_header_bytes_at_front)],exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(memcpy),exp:&ref:exp:ident(file_size),exp:ident(page_virt),exp:sizeof:exp:ident(file_size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:call[exp:ident(be64_to_cpu),exp:ident(file_size)]]]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:record_ptr[exp:ident(dentry),ident(d_inode)],exp:cast[fulltype[typec(N/H)],exp:ident(file_size)]],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(ecryptfs_header_cache_2),exp:ident(page_virt)],stmt:goto(out),statem(N/H),stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],statem(N/H)]],def[fname(ecryptfs_link),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(old_dentry),fulltype[typec(N/H)]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(new_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size_save),exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(old_dentry),ident(d_inode)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(new_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_new_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_link),exp:ident(lower_old_dentry),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_new_dentry)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_new_dentry),exp:ident(new_dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(old_dentry),ident(d_inode)],ident(i_nlink)],exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_lower),exp:record_ptr[exp:ident(old_dentry),ident(d_inode)]],ident(i_nlink)]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:record_ptr[exp:ident(new_dentry),ident(d_inode)],exp:ident(file_size_save)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(new_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(old_dentry)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_unlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_unlink),exp:ident(lower_dir_inode),exp:ident(lower_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_unlock)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:ident(lower_dir_inode)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_nlink)],exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_lower),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(i_nlink)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_ctime)],exp:record_ptr[exp:ident(dir),ident(i_ctime)]],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],statem(N/H),stmt:return:exp:ident(rc)]],def[fname(ecryptfs_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(symname),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mode),exp:ident(S_IALLUGO)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(encoded_symlen),exp:call[exp:ident(ecryptfs_encode_filename),exp:ident(crypt_stat),exp:ident(symname),exp:call[exp:ident(strlen),exp:ident(symname)],exp:&ref:exp:ident(encoded_symname)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(encoded_symlen),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:ident(encoded_symlen)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_symlink),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(encoded_symname),exp:ident(mode)]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(encoded_symname)],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_dentry)],stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_mkdir),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_mkdir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(mode)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dir),ident(i_nlink)],exp:record_ptr[exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],ident(i_nlink)]],statem(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_rmdir),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_rmdir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_dentry)],stmt:if[exp:!:exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(d_delete),exp:ident(lower_dentry)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dir),ident(i_nlink)],exp:record_ptr[exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],ident(i_nlink)]],stmt:exprstmt:exp:call[exp:ident(unlock_dir),exp:ident(lower_dir_dentry)],stmt:if[exp:!:exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(dentry)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_mknod),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_mknod),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(mode),exp:ident(dev)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_rename),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(old_dir),fulltype[typec(N/H)]],param[reg(),name(old_dentry),fulltype[typec(N/H)]],param[reg(),name(new_dir),fulltype[typec(N/H)]],param[reg(),name(new_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(new_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dir_dentry),exp:call[exp:ident(dget_parent),exp:ident(lower_old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dir_dentry),exp:call[exp:ident(dget_parent),exp:ident(lower_new_dentry)]],stmt:exprstmt:exp:call[exp:ident(lock_rename),exp:ident(lower_old_dir_dentry),exp:ident(lower_new_dir_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_rename),exp:record_ptr[exp:ident(lower_old_dir_dentry),ident(d_inode)],exp:ident(lower_old_dentry),exp:record_ptr[exp:ident(lower_new_dir_dentry),ident(d_inode)],exp:ident(lower_new_dentry)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_all),exp:ident(new_dir),exp:record_ptr[exp:ident(lower_new_dir_dentry),ident(d_inode)],exp:ident(NULL)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(new_dir),exp:ident(old_dir)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_all),exp:ident(old_dir),exp:record_ptr[exp:ident(lower_old_dir_dentry),ident(d_inode)],exp:ident(NULL)],stmt:exprstmt(none)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_parent)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(lower_old_dentry),ident(d_parent)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_old_dentry)],stmt:return:exp:ident(rc)]],NCP(N/H),NCP(N/H),def[fname(ecryptfs_put_link),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]],param[reg(),name(ptr),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kfree),exp:call[exp:ident(nd_get_link),exp:ident(nd)]]]],def[fname(upper_size_to_lower_size),funtype[fulltype[typec(N/H)],param[reg(),name(crypt_stat),fulltype[typec(N/H)]],param[reg(),name(upper_size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size),exp:record_ptr[exp:ident(crypt_stat),ident(num_header_bytes_at_front)]],stmt:if[exp:binary_logi[logiop(!=),exp:ident(upper_size),exp:const:int(0)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(num_extents),exp:binary_arith[aop(>>),exp:ident(upper_size),exp:record_ptr[exp:ident(crypt_stat),ident(extent_shift)]]],stmt:if[exp:binary_arith[aop(&),exp:ident(upper_size),exp:~:exp:record_ptr[exp:ident(crypt_stat),ident(extent_mask)]],stmt:exprstmt:exp:postfix:++:exp:ident(num_extents),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(+=),exp:ident(lower_size),exp:binary_arith[aop(*),exp:ident(num_extents),exp:record_ptr[exp:ident(crypt_stat),ident(extent_size)]]]],stmt:exprstmt(none)],stmt:return:exp:ident(lower_size)]],def[fname(ecryptfs_truncate),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(new_length),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:call[exp:ident(unlikely),exp:binary_logi[logiop(==),exp:ident(new_length),exp:ident(i_size)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(fake_ecryptfs_file),exp:const:int(0),exp:sizeof:exp:ident(fake_ecryptfs_file)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_ecryptfs_file),ident(f_path)],ident(dentry)],exp:ident(dentry)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_private),exp:&ref:exp:ident(fake_ecryptfs_file),exp:call[exp:ident(kmem_cache_alloc),exp:ident(ecryptfs_file_info_cache),exp:ident(GFP_KERNEL)]],stmt:if[exp:call[exp:ident(unlikely),exp:!:exp:call[exp:ident(ecryptfs_file_to_private),exp:&ref:exp:ident(fake_ecryptfs_file)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_lower),exp:&ref:exp:ident(fake_ecryptfs_file),exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(lower_file)]],stmt:if[exp:binary_logi[logiop(>),exp:ident(new_length),exp:ident(i_size)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_ecryptfs_file),exp:ident(zero),exp:binary_arith[aop(-),exp:ident(new_length),exp:const:int(1)],exp:const:int(1)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(num_zeros),stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(zeros_virt),exp:call[exp:ident(kzalloc),exp:ident(num_zeros),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:ident(zeros_virt),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:goto(out_free)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_ecryptfs_file),exp:ident(zeros_virt),exp:ident(new_length),exp:ident(num_zeros)]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(zeros_virt)],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_free)],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(vmtruncate),exp:ident(inode),exp:ident(new_length)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_inode_size_to_metadata),exp:ident(inode)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_free)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size_before_truncate),exp:call[exp:ident(upper_size_to_lower_size),exp:ident(crypt_stat),exp:ident(i_size)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size_after_truncate),exp:call[exp:ident(upper_size_to_lower_size),exp:ident(crypt_stat),exp:ident(new_length)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(lower_size_after_truncate),exp:ident(lower_size_before_truncate)],stmt:exprstmt:exp:call[exp:ident(vmtruncate),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],exp:ident(lower_size_after_truncate)],stmt:exprstmt(none)]]],statem(N/H),statem(N/H)]],def[fname(ecryptfs_permission),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(mask),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(nd),ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(nd),ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_setattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(ia),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_STRUCT_INITIALIZED)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_init_crypt_stat),exp:ident(crypt_stat)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_inode),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_mode)]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:if[exp:binary_logi[logiop(&&),exp:call[exp:ident(S_ISREG),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_mode)]],exp:binary_logi[logiop(||),exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_POLICY_APPLIED)],exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_KEY_VALID)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mount_crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_superblock_to_private),exp:record_ptr[exp:ident(dentry),ident(d_sb)]],ident(mount_crypt_stat)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_metadata),exp:ident(dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(mount_crypt_stat),ident(flags)],exp:ident(ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(EIO)],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:const:int(0)],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:goto(out)],stmt:exprstmt(none)]],stmt:exprstmt(none)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:ident(ATTR_SIZE)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:ident(ATTR_SIZE)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_truncate),exp:ident(dentry),exp:record_ptr[exp:ident(ia),ident(ia_size)]]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:~:exp:ident(ATTR_SIZE)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(ia->ia_valid = [%x]\n),exp:record_ptr[exp:ident(ia),ident(ia_valid)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(rc),exp:const:int(0)],stmt:goto(out),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:binary_arith[aop(|),exp:ident(ATTR_KILL_SUID),exp:ident(ATTR_KILL_SGID)]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:~:exp:ident(ATTR_MODE)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(notify_change),exp:ident(lower_dentry),exp:ident(ia)]],statem(N/H),stmt:return:exp:ident(rc)]],def[fname(ecryptfs_setxattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(setxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(setxattr)],exp:ident(lower_dentry),exp:ident(name),exp:ident(value),exp:ident(size),exp:ident(flags)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_getxattr_lower),funtype[fulltype[typec(N/H)],param[reg(),name(lower_dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(getxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(getxattr)],exp:ident(lower_dentry),exp:ident(name),exp:ident(value),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_getxattr),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(ecryptfs_getxattr_lower),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)],exp:ident(name),exp:ident(value),exp:ident(size)]]],def[fname(ecryptfs_listxattr),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(list),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(listxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(listxattr)],exp:ident(lower_dentry),exp:ident(list),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_removexattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(removexattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(removexattr)],exp:ident(lower_dentry),exp:ident(name)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_inode_test),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(candidate_lower_inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:cast[fulltype[typec(N/H)],exp:ident(candidate_lower_inode)]],stmt:return:exp:const:int(1),stmt:return:exp:const:int(0)]]],def[fname(ecryptfs_inode_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(lower_inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_init_inode),exp:ident(inode),exp:cast[fulltype[typec(N/H)],exp:ident(lower_inode)]],stmt:return:exp:const:int(0)]],decl(N/H),decl(N/H),decl(N/H)] ==> prg2[includeN[inc_elem(linux),inc_elem(file.h)],includeN[inc_elem(linux),inc_elem(vmalloc.h)],includeN[inc_elem(linux),inc_elem(pagemap.h)],includeN[inc_elem(linux),inc_elem(dcache.h)],includeN[inc_elem(linux),inc_elem(namei.h)],includeN[inc_elem(linux),inc_elem(mount.h)],includeN[inc_elem(linux),inc_elem(crypto.h)],includeN[inc_elem(linux),inc_elem(fs_stack.h)],includeL[inc_elem(ecryptfs_kernel.h)],def[fname(lock_parent),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dir),exp:call[exp:ident(dget),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]],stmt:exprstmt:exp:call[exp:ident(mutex_lock_nested),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(dir),ident(d_inode)],ident(i_mutex)],exp:ident(I_MUTEX_PARENT)],stmt:return:exp:ident(dir)]],def[fname(unlock_parent),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_parent)],ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]]],def[fname(unlock_dir),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dir),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(dir),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(dir)]]],def[fname(ecryptfs_create_underlying_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(lower_dir_inode),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(dentry_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(vfsmount_save),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(lower_mnt)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_create),exp:ident(lower_dir_inode),exp:ident(lower_dentry),exp:ident(mode),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmount_save)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_do_create),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(directory_inode),fulltype[typec(N/H)]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(ecryptfs_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:if[exp:call[exp:ident(unlikely),exp:call[exp:ident(IS_ERR),exp:ident(lower_dir_dentry)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(PTR_ERR),exp:ident(lower_dir_dentry)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_create_underlying_file),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(ecryptfs_dentry),exp:ident(mode),exp:ident(nd)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(__FUNCTION__),exp:ident(rc)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(ecryptfs_dentry),exp:record_ptr[exp:ident(directory_inode),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Failure in ecryptfs_interpose\n)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(directory_inode),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(directory_inode),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),statem(N/H)]],def[fname(grow_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(fake_file),exp:const:int(0),exp:sizeof:exp:ident(fake_file)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_file),ident(f_path)],ident(dentry)],exp:ident(ecryptfs_dentry)],stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(tmp_file_info),exp:const:int(0),exp:sizeof:exp:ident(tmp_file_info)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_private),exp:&ref:exp:ident(fake_file),exp:&ref:exp:ident(tmp_file_info)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_lower),exp:&ref:exp:ident(fake_file),exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:ident(ecryptfs_inode)],ident(lower_file)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_file),exp:ident(zero_virt),exp:const:int(0),exp:const:int(1)]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:ident(ecryptfs_inode),exp:const:int(0)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_inode_size_to_metadata),exp:ident(ecryptfs_inode)]],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_acc[exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:ident(ecryptfs_inode)],ident(crypt_stat)],ident(flags)],exp:ident(ECRYPTFS_NEW_FILE)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_initialize_file),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:record_ptr[exp:ident(ecryptfs_dentry),ident(d_inode)],ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(This is a directory\n)],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_NEW_FILE)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Initializing crypto context\n)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_new_file_context),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_metadata),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(grow_file),exp:ident(ecryptfs_dentry)]],stmt:if[exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:exprstmt(none)],statem(N/H)]],def[fname(ecryptfs_create),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(directory_inode),fulltype[typec(N/H)]],param[reg(),name(ecryptfs_dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_do_create),exp:ident(directory_inode),exp:ident(ecryptfs_dentry),exp:ident(mode),exp:ident(nd)]],stmt:if[exp:call[exp:ident(unlikely),exp:ident(rc)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_WARNING),exp:const:other(N/H)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_initialize_file),exp:ident(ecryptfs_dentry)]],statem(N/H)]],def[fname(ecryptfs_lookup),funtype[fulltype[typec(N/H)],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dentry),ident(d_op)],exp:&ref:exp:ident(ecryptfs_dops)],stmt:if[exp:binary_logi[logiop(||),exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:const:int(1)],exp:!:exp:call[exp:ident(strcmp),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:const:string(.)]],exp:binary_logi[logiop(&&),exp:binary_logi[logiop(==),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:const:int(2)],exp:!:exp:call[exp:ident(strcmp),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:const:string(..)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(encoded_namelen),exp:call[exp:ident(ecryptfs_encode_filename),exp:ident(crypt_stat),exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(name)],exp:record_acc[exp:record_ptr[exp:ident(dentry),ident(d_name)],ident(len)],exp:&ref:exp:ident(encoded_name)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(encoded_namelen),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:ident(encoded_namelen)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:ident(encoded_name),exp:ident(encoded_namelen)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(lookup_one_len),exp:ident(encoded_name),exp:ident(lower_dir_dentry),exp:binary_arith[aop(-),exp:ident(encoded_namelen),exp:const:int(1)]]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(encoded_name)],stmt:if[exp:call[exp:ident(IS_ERR),exp:ident(lower_dentry)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(ERR from lower_dentry\n)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(PTR_ERR),exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_mnt),exp:call[exp:ident(mntget),exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_ptr[exp:ident(dentry),ident(d_parent)]]]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:ident(lower_dentry),exp:record_acc[exp:record_ptr[exp:ident(lower_dentry),ident(d_name)],ident(name)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_inode),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_atime),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(BUG_ON),exp:!:exp:call[exp:ident(atomic_read),exp:&ref:exp:record_ptr[exp:ident(lower_dentry),ident(d_count)]]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_private),exp:ident(dentry),exp:call[exp:ident(kmem_cache_alloc),exp:ident(ecryptfs_dentry_info_cache),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:call[exp:ident(ecryptfs_dentry_to_private),exp:ident(dentry)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:other(N/H)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_lower),exp:ident(dentry),exp:ident(lower_dentry)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_dentry_lower_mnt),exp:ident(dentry),exp:ident(lower_mnt)],stmt:if[exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(d_add),exp:ident(dentry),exp:ident(NULL)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(1)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Error interposing\n)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a directory; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(S_ISLNK),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a symlink; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:call[exp:ident(special_file),exp:record_ptr[exp:ident(lower_inode),ident(i_mode)]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(Is a special file; returning\n)],stmt:goto(out)],stmt:exprstmt(none)],stmt:if[exp:!:exp:ident(nd),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(page_virt),exp:call[exp:ident(kmem_cache_zalloc),exp:ident(ecryptfs_header_cache_2),exp:ident(GFP_USER)]],stmt:if[exp:!:exp:ident(page_virt),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_ERR),exp:const:string(Cannot ecryptfs_kmalloc a page\n)],stmt:goto(out_dput)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_POLICY_APPLIED)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_default_sizes),exp:ident(crypt_stat)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_and_validate_header_region),exp:ident(page_virt),exp:record_ptr[exp:ident(dentry),ident(d_inode)]]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_and_validate_xattr_region),exp:ident(page_virt),exp:ident(dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:const:int(0)],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(ecryptfs_header_cache_2),exp:ident(page_virt)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(|=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_METADATA_IN_XATTR)]],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mount_crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_superblock_to_private),exp:record_ptr[exp:ident(dentry),ident(d_sb)]],ident(mount_crypt_stat)]],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(mount_crypt_stat),ident(flags)],exp:ident(ECRYPTFS_ENCRYPTED_VIEW_ENABLED)],stmt:comp{}[stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_METADATA_IN_XATTR)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:binary_arith[aop(+),exp:record_ptr[exp:ident(crypt_stat),ident(num_header_bytes_at_front)],exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]]]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(memcpy),exp:&ref:exp:ident(file_size),exp:ident(page_virt),exp:sizeof:exp:ident(file_size)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size),exp:call[exp:ident(be64_to_cpu),exp:ident(file_size)]]]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:record_ptr[exp:ident(dentry),ident(d_inode)],exp:cast[fulltype[typec(N/H)],exp:ident(file_size)]],stmt:exprstmt:exp:call[exp:ident(kmem_cache_free),exp:ident(ecryptfs_header_cache_2),exp:ident(page_virt)],stmt:goto(out),statem(N/H),stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],statem(N/H)]],def[fname(ecryptfs_link),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(old_dentry),fulltype[typec(N/H)]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(new_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(file_size_save),exp:call[exp:ident(i_size_read),exp:record_ptr[exp:ident(old_dentry),ident(d_inode)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(new_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_new_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_link),exp:ident(lower_old_dentry),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_new_dentry)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_new_dentry),exp:ident(new_dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(old_dentry),ident(d_inode)],ident(i_nlink)],exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_lower),exp:record_ptr[exp:ident(old_dentry),ident(d_inode)]],ident(i_nlink)]],stmt:exprstmt:exp:call[exp:ident(i_size_write),exp:record_ptr[exp:ident(new_dentry),ident(d_inode)],exp:ident(file_size_save)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(new_dentry)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(old_dentry)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_unlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_unlink),exp:ident(lower_dir_inode),exp:ident(lower_dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_unlock)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:ident(lower_dir_inode)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_nlink)],exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_lower),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(i_nlink)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_ctime)],exp:record_ptr[exp:ident(dir),ident(i_ctime)]],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],statem(N/H),stmt:return:exp:ident(rc)]],def[fname(ecryptfs_symlink),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(symname),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mode),exp:ident(S_IALLUGO)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(encoded_symlen),exp:call[exp:ident(ecryptfs_encode_filename),exp:ident(crypt_stat),exp:ident(symname),exp:call[exp:ident(strlen),exp:ident(symname)],exp:&ref:exp:ident(encoded_symname)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(encoded_symlen),exp:const:int(0)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:ident(encoded_symlen)],stmt:goto(out_lock)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_symlink),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(encoded_symname),exp:ident(mode)]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(encoded_symname)],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_dentry)],stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_mkdir),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_mkdir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(mode)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dir),ident(i_nlink)],exp:record_ptr[exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],ident(i_nlink)]],statem(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_rmdir),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_rmdir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_dentry)],stmt:if[exp:!:exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(d_delete),exp:ident(lower_dentry)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_ptr[exp:ident(dir),ident(i_nlink)],exp:record_ptr[exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],ident(i_nlink)]],stmt:exprstmt:exp:call[exp:ident(unlock_dir),exp:ident(lower_dir_dentry)],stmt:if[exp:!:exp:ident(rc),stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(dentry)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_mknod),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dir),fulltype[typec(N/H)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(mode),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(dev),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dir_dentry),exp:call[exp:ident(lock_parent),exp:ident(lower_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_mknod),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)],exp:ident(lower_dentry),exp:ident(mode),exp:ident(dev)]],stmt:if[exp:binary_logi[logiop(||),exp:ident(rc),exp:!:exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_interpose),exp:ident(lower_dentry),exp:ident(dentry),exp:record_ptr[exp:ident(dir),ident(i_sb)],exp:const:int(0)]],stmt:if[exp:ident(rc),stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_times),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_inode_size),exp:ident(dir),exp:record_ptr[exp:ident(lower_dir_dentry),ident(d_inode)]],statem(N/H),stmt:if[exp:!:exp:record_ptr[exp:ident(dentry),ident(d_inode)],stmt:exprstmt:exp:call[exp:ident(d_drop),exp:ident(dentry)],stmt:exprstmt(none)],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_rename),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(old_dir),fulltype[typec(N/H)]],param[reg(),name(old_dentry),fulltype[typec(N/H)]],param[reg(),name(new_dir),fulltype[typec(N/H)]],param[reg(),name(new_dentry),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(new_dentry)]],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_old_dentry)],stmt:exprstmt:exp:call[exp:ident(dget),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_old_dir_dentry),exp:call[exp:ident(dget_parent),exp:ident(lower_old_dentry)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_new_dir_dentry),exp:call[exp:ident(dget_parent),exp:ident(lower_new_dentry)]],stmt:exprstmt:exp:call[exp:ident(lock_rename),exp:ident(lower_old_dir_dentry),exp:ident(lower_new_dir_dentry)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(vfs_rename),exp:record_ptr[exp:ident(lower_old_dir_dentry),ident(d_inode)],exp:ident(lower_old_dentry),exp:record_ptr[exp:ident(lower_new_dir_dentry),ident(d_inode)],exp:ident(lower_new_dentry)]],stmt:if[exp:ident(rc),stmt:goto(out_lock),stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_all),exp:ident(new_dir),exp:record_ptr[exp:ident(lower_new_dir_dentry),ident(d_inode)],exp:ident(NULL)],stmt:if[exp:binary_logi[logiop(!=),exp:ident(new_dir),exp:ident(old_dir)],stmt:exprstmt:exp:call[exp:ident(fsstack_copy_attr_all),exp:ident(old_dir),exp:record_ptr[exp:ident(lower_old_dir_dentry),ident(d_inode)],exp:ident(NULL)],stmt:exprstmt(none)],statem(N/H),stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(lower_new_dentry),ident(d_parent)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:record_ptr[exp:ident(lower_old_dentry),ident(d_parent)]],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_new_dentry)],stmt:exprstmt:exp:call[exp:ident(dput),exp:ident(lower_old_dentry)],stmt:return:exp:ident(rc)]],NCP(N/H),NCP(N/H),def[fname(ecryptfs_put_link),funtype[fulltype[ctype[btype(void)]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(nd),fulltype[typec(N/H)]],param[reg(),name(ptr),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(kfree),exp:call[exp:ident(nd_get_link),exp:ident(nd)]]]],def[fname(upper_size_to_lower_size),funtype[fulltype[typec(N/H)],param[reg(),name(crypt_stat),fulltype[typec(N/H)]],param[reg(),name(upper_size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size),exp:record_ptr[exp:ident(crypt_stat),ident(num_header_bytes_at_front)]],stmt:if[exp:binary_logi[logiop(!=),exp:ident(upper_size),exp:const:int(0)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(num_extents),exp:binary_arith[aop(>>),exp:ident(upper_size),exp:record_ptr[exp:ident(crypt_stat),ident(extent_shift)]]],stmt:if[exp:binary_arith[aop(&),exp:ident(upper_size),exp:~:exp:record_ptr[exp:ident(crypt_stat),ident(extent_mask)]],stmt:exprstmt:exp:postfix:++:exp:ident(num_extents),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[op_assi(+=),exp:ident(lower_size),exp:binary_arith[aop(*),exp:ident(num_extents),exp:record_ptr[exp:ident(crypt_stat),ident(extent_size)]]]],stmt:exprstmt(none)],stmt:return:exp:ident(lower_size)]],def[fname(ecryptfs_truncate),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(new_length),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:if[exp:call[exp:ident(unlikely),exp:binary_logi[logiop(==),exp:ident(new_length),exp:ident(i_size)]],stmt:goto(out),stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:exprstmt:exp:call[exp:ident(memset),exp:&ref:exp:ident(fake_ecryptfs_file),exp:const:int(0),exp:sizeof:exp:ident(fake_ecryptfs_file)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_acc[exp:ident(fake_ecryptfs_file),ident(f_path)],ident(dentry)],exp:ident(dentry)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_private),exp:&ref:exp:ident(fake_ecryptfs_file),exp:call[exp:ident(kmem_cache_alloc),exp:ident(ecryptfs_file_info_cache),exp:ident(GFP_KERNEL)]],stmt:if[exp:call[exp:ident(unlikely),exp:!:exp:call[exp:ident(ecryptfs_file_to_private),exp:&ref:exp:ident(fake_ecryptfs_file)]],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(ecryptfs_set_file_lower),exp:&ref:exp:ident(fake_ecryptfs_file),exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(lower_file)]],stmt:if[exp:binary_logi[logiop(>),exp:ident(new_length),exp:ident(i_size)],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_ecryptfs_file),exp:ident(zero),exp:binary_arith[aop(-),exp:ident(new_length),exp:const:int(1)],exp:const:int(1)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(num_zeros),stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(zeros_virt),exp:call[exp:ident(kzalloc),exp:ident(num_zeros),exp:ident(GFP_KERNEL)]],stmt:if[exp:!:exp:ident(zeros_virt),stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOMEM)],stmt:goto(out_free)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write),exp:&ref:exp:ident(fake_ecryptfs_file),exp:ident(zeros_virt),exp:ident(new_length),exp:ident(num_zeros)]],stmt:exprstmt:exp:call[exp:ident(kfree),exp:ident(zeros_virt)],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_free)],stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(vmtruncate),exp:ident(inode),exp:ident(new_length)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_write_inode_size_to_metadata),exp:ident(inode)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H),exp:ident(rc)],stmt:goto(out_free)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size_before_truncate),exp:call[exp:ident(upper_size_to_lower_size),exp:ident(crypt_stat),exp:ident(i_size)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_size_after_truncate),exp:call[exp:ident(upper_size_to_lower_size),exp:ident(crypt_stat),exp:ident(new_length)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(lower_size_after_truncate),exp:ident(lower_size_before_truncate)],stmt:exprstmt:exp:call[exp:ident(vmtruncate),exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],exp:ident(lower_size_after_truncate)],stmt:exprstmt(none)]]],statem(N/H),statem(N/H)]],def[fname(ecryptfs_permission),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(mask),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]],param[reg(),name(nd),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:ident(nd),stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:call[exp:ident(ecryptfs_dentry_to_lower_mnt),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)]]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(nd)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(mnt)],exp:ident(vfsmnt_save)],stmt:exprstmt:exp:assign[simple_assi(=),exp:record_acc[exp:record_ptr[exp:ident(nd),ident(path)],ident(dentry)],exp:ident(dentry_save)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(permission),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:ident(mask),exp:ident(NULL)]]],stmt:return:exp:ident(rc)]],def[fname(ecryptfs_setattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(ia),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_inode_to_private),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],ident(crypt_stat)]],stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_STRUCT_INITIALIZED)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_init_crypt_stat),exp:ident(crypt_stat)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(inode),exp:record_ptr[exp:ident(dentry),ident(d_inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_inode),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:if[exp:call[exp:ident(S_ISDIR),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_mode)]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:if[exp:binary_logi[logiop(&&),exp:call[exp:ident(S_ISREG),exp:record_ptr[exp:record_ptr[exp:ident(dentry),ident(d_inode)],ident(i_mode)]],exp:binary_logi[logiop(||),exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_POLICY_APPLIED)],exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:ident(ECRYPTFS_KEY_VALID)]]],stmt:comp{}[stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(mount_crypt_stat),exp:&ref:exp:record_ptr[exp:call[exp:ident(ecryptfs_superblock_to_private),exp:record_ptr[exp:ident(dentry),ident(d_sb)]],ident(mount_crypt_stat)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_read_metadata),exp:ident(dentry)]],stmt:if[exp:ident(rc),stmt:comp{}[stmt:if[exp:!:exp:binary_arith[aop(&),exp:record_ptr[exp:ident(mount_crypt_stat),ident(flags)],exp:ident(ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(EIO)],stmt:exprstmt:exp:call[exp:ident(printk),exp:const:other(N/H)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:const:int(0)],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(crypt_stat),ident(flags)],exp:~:exp:ident(ECRYPTFS_ENCRYPTED)],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:goto(out)],stmt:exprstmt(none)]],stmt:exprstmt(none)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:ident(crypt_stat),ident(cs_mutex)]],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:ident(ATTR_SIZE)],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:other(N/H),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:ident(ATTR_SIZE)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(ecryptfs_truncate),exp:ident(dentry),exp:record_ptr[exp:ident(ia),ident(ia_size)]]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:~:exp:ident(ATTR_SIZE)],stmt:exprstmt:exp:call[exp:ident(ecryptfs_printk),exp:ident(KERN_DEBUG),exp:const:string(ia->ia_valid = [%x]\n),exp:record_ptr[exp:ident(ia),ident(ia_valid)]],stmt:if[exp:binary_logi[logiop(<),exp:ident(rc),exp:const:int(0)],stmt:goto(out),stmt:exprstmt(none)]],stmt:exprstmt(none)],stmt:if[exp:binary_arith[aop(&),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:binary_arith[aop(|),exp:ident(ATTR_KILL_SUID),exp:ident(ATTR_KILL_SGID)]],stmt:exprstmt:exp:assign[op_assi(&=),exp:record_ptr[exp:ident(ia),ident(ia_valid)],exp:~:exp:ident(ATTR_MODE)],stmt:exprstmt(none)],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:ident(notify_change),exp:ident(lower_dentry),exp:ident(ia)]],statem(N/H),stmt:return:exp:ident(rc)]],def[fname(ecryptfs_setxattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]],param[reg(),name(flags),fulltype[ctype[btype[itype[sgn(signed),base(int)]]]]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(setxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(setxattr)],exp:ident(lower_dentry),exp:ident(name),exp:ident(value),exp:ident(size),exp:ident(flags)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_getxattr_lower),funtype[fulltype[typec(N/H)],param[reg(),name(lower_dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(getxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(getxattr)],exp:ident(lower_dentry),exp:ident(name),exp:ident(value),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_getxattr),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]],param[reg(),name(value),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:return:exp:call[exp:ident(ecryptfs_getxattr_lower),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)],exp:ident(name),exp:ident(value),exp:ident(size)]]],def[fname(ecryptfs_listxattr),funtype[fulltype[typec(N/H)],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(list),fulltype[typec(N/H)]],param[reg(),name(size),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(listxattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(listxattr)],exp:ident(lower_dentry),exp:ident(list),exp:ident(size)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_removexattr),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(dentry),fulltype[typec(N/H)]],param[reg(),name(name),fulltype[typec(N/H)]]],stmt:comp{}[stmt:decl(N/H),stmt:decl(N/H),stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(lower_dentry),exp:call[exp:ident(ecryptfs_dentry_to_lower),exp:ident(dentry)]],stmt:if[exp:!:exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(removexattr)],stmt:comp{}[stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:-:exp:ident(ENOSYS)],stmt:goto(out)],stmt:exprstmt(none)],stmt:exprstmt:exp:call[exp:ident(mutex_lock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],stmt:exprstmt:exp:assign[simple_assi(=),exp:ident(rc),exp:call[exp:record_ptr[exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_op)],ident(removexattr)],exp:ident(lower_dentry),exp:ident(name)]],stmt:exprstmt:exp:call[exp:ident(mutex_unlock),exp:&ref:exp:record_ptr[exp:record_ptr[exp:ident(lower_dentry),ident(d_inode)],ident(i_mutex)]],statem(N/H)]],def[fname(ecryptfs_inode_test),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(candidate_lower_inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:if[exp:binary_logi[logiop(==),exp:call[exp:ident(ecryptfs_inode_to_lower),exp:ident(inode)],exp:cast[fulltype[typec(N/H)],exp:ident(candidate_lower_inode)]],stmt:return:exp:const:int(1),stmt:return:exp:const:int(0)]]],def[fname(ecryptfs_inode_set),funtype[fulltype[ctype[btype[itype[sgn(signed),base(int)]]]],param[reg(),name(inode),fulltype[typec(N/H)]],param[reg(),name(lower_inode),fulltype[typec(N/H)]]],stmt:comp{}[stmt:exprstmt:exp:call[exp:ident(ecryptfs_init_inode),exp:ident(inode),exp:cast[fulltype[typec(N/H)],exp:ident(lower_inode)]],stmt:return:exp:const:int(0)]],decl(N/H),decl(N/H),decl(N/H)]

  
}}}
Raw list of simple updates
{{{
}}}
[Main] generating solutions...
[Main] no solutions?
